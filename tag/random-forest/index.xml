<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Random Forest | Hua' Cabin</title><link>https://zouhua.top/tag/random-forest/</link><atom:link href="https://zouhua.top/tag/random-forest/index.xml" rel="self" type="application/rss+xml"/><description>Random Forest</description><generator>Wowchemy (https://wowchemy.com)</generator><language>en-us</language><copyright>© 2023 Hua Zou</copyright><lastBuildDate>Wed, 26 Apr 2023 20:13:14 +0000</lastBuildDate><image><url>https://zouhua.top/media/icon_hub9a637e5d84e6d4c134f91fa57903eec_55838_512x512_fill_lanczos_center_3.png</url><title>Random Forest</title><link>https://zouhua.top/tag/random-forest/</link></image><item><title>How to choose the optimal features in Random Forest using R</title><link>https://zouhua.top/post/machine_learning/2023-04-27-ml010-rfoptimal/</link><pubDate>Wed, 26 Apr 2023 20:13:14 +0000</pubDate><guid>https://zouhua.top/post/machine_learning/2023-04-27-ml010-rfoptimal/</guid><description>&lt;h1 id="how-to-choose-the-optimal-biomarkers-in-random-forest">How to choose the optimal biomarkers in Random Forest&lt;/h1>
&lt;p>Random Forest, a ensemble machine learning algorithm with multiple decision trees could be used for classification or regression algorithm, and it has an elegant way of dealing with nonlinear or linear data.&lt;/p>
&lt;blockquote>
&lt;p>Random forest aims to reduce the previously mentioned correlation issue by choosing only a subsample of the feature space at each split. Essentially, it aims to make the trees de-correlated and prune the trees by setting a stopping criteria for node splits, which I will cover in more detail later.&lt;/p>
&lt;/blockquote>
&lt;p>However, how to choose the optimal features to rebuild models is the key step for users. Herein, we gave the detailed tutorial step by step.&lt;/p>
&lt;h2 id="importing-packages">Importing packages&lt;/h2>
&lt;p>R packages used in this tutorial.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-r" data-lang="r">&lt;span class="line">&lt;span class="cl">&lt;span class="n">knitr&lt;/span>&lt;span class="o">::&lt;/span>&lt;span class="n">opts_chunk&lt;/span>&lt;span class="o">$&lt;/span>&lt;span class="nf">set&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">message&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="kc">FALSE&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">warning&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="kc">FALSE&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nf">library&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">dplyr&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nf">library&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">tibble&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nf">library&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">randomForest&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nf">library&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">ggplot2&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nf">library&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">data.table&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nf">library&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">caret&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nf">library&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">pROC&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># rm(list = ls())&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nf">options&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">stringsAsFactors&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="bp">F&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nf">options&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">future.globals.maxSize&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="m">1000&lt;/span> &lt;span class="o">*&lt;/span> &lt;span class="m">1024&lt;/span>&lt;span class="n">^2&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="importing-data">Importing data&lt;/h2>
&lt;p>&lt;code>clean_data.csv&lt;/code> is from &lt;a href="https://github.com/Jean-njoroge/Breast-cancer-risk-prediction/blob/master/data/clean-data.csv" target="_blank" rel="noopener">Breast-cancer-risk-prediction&lt;/a>. Using &lt;em>wget &lt;a href="https://github.com/Jean-njoroge/Breast-cancer-risk-prediction/blob/master/data/clean-data.csv" target="_blank" rel="noopener">https://github.com/Jean-njoroge/Breast-cancer-risk-prediction/blob/master/data/clean-data.csv&lt;/a>&lt;/em> to download it.&lt;/p>
&lt;p>&lt;code>clean_data.csv&lt;/code> contains 569 samples of malignant and benign tumor cells&lt;/p>
&lt;blockquote>
&lt;p>The Breast Cancer datasets is available machine learning repository maintained by the University of California, Irvine. The dataset contains 569 samples of malignant and benign tumor cells.&lt;/p>
&lt;/blockquote>
&lt;blockquote>
&lt;ol>
&lt;li>The first two columns in the dataset store the unique ID numbers of the samples and the corresponding diagnosis (M=malignant, B=benign), respectively.&lt;/li>
&lt;/ol>
&lt;/blockquote>
&lt;blockquote>
&lt;ol start="2">
&lt;li>The columns 3-32 contain 30 real-value features that have been computed from digitized images of the cell nuclei, which can be used to build a model to predict whether a tumor is benign or malignant.&lt;/li>
&lt;/ol>
&lt;/blockquote>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-r" data-lang="r">&lt;span class="line">&lt;span class="cl">&lt;span class="n">datset&lt;/span> &lt;span class="o">&amp;lt;-&lt;/span> &lt;span class="n">data.table&lt;/span>&lt;span class="o">::&lt;/span>&lt;span class="nf">fread&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;clean_data.csv&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nf">head&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">datset[&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="m">1&lt;/span>&lt;span class="o">:&lt;/span>&lt;span class="m">6&lt;/span>&lt;span class="n">]&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-markdown" data-lang="markdown">&lt;span class="line">&lt;span class="cl"> V1 diagnosis radius_mean texture_mean perimeter_mean
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">1: 0 M 17.99 10.38 122.80
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">2: 1 M 20.57 17.77 132.90
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">3: 2 M 19.69 21.25 130.00
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">4: 3 M 11.42 20.38 77.58
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">5: 4 M 20.29 14.34 135.10
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">6: 5 M 12.45 15.70 82.57
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="data-partition">Data Partition&lt;/h2>
&lt;p>Splitting dataset into TrainSet and TestSet, the former is used to build random forest model and the latter is used to evaluate the performance of model.&lt;/p>
&lt;p>We used &lt;code>caret::createDataPartition&lt;/code> with parameters &lt;code>p = 0.7&lt;/code> to create trainData and testData dataset.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-r" data-lang="r">&lt;span class="line">&lt;span class="cl">&lt;span class="n">mdat&lt;/span> &lt;span class="o">&amp;lt;-&lt;/span> &lt;span class="n">datset&lt;/span> &lt;span class="o">%&amp;gt;%&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">dplyr&lt;/span>&lt;span class="o">::&lt;/span>&lt;span class="nf">select&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">V1&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">%&amp;gt;%&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">dplyr&lt;/span>&lt;span class="o">::&lt;/span>&lt;span class="nf">rename&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">Group&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">diagnosis&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">%&amp;gt;%&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">dplyr&lt;/span>&lt;span class="o">::&lt;/span>&lt;span class="nf">mutate&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">Group&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nf">factor&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">Group&lt;/span>&lt;span class="p">))&lt;/span> &lt;span class="o">%&amp;gt;%&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nf">data.frame&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nf">colnames&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">mdat&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">&amp;lt;-&lt;/span> &lt;span class="nf">make.names&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nf">colnames&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">mdat&lt;/span>&lt;span class="p">))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nf">set.seed&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="m">123&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">trainIndex&lt;/span> &lt;span class="o">&amp;lt;-&lt;/span> &lt;span class="n">caret&lt;/span>&lt;span class="o">::&lt;/span>&lt;span class="nf">createDataPartition&lt;/span>&lt;span class="p">(&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">mdat&lt;/span>&lt;span class="o">$&lt;/span>&lt;span class="n">Group&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">p&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="m">0.7&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">list&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="kc">FALSE&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">times&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="m">1&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">trainData&lt;/span> &lt;span class="o">&amp;lt;-&lt;/span> &lt;span class="n">mdat[trainIndex&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">X_train&lt;/span> &lt;span class="o">&amp;lt;-&lt;/span> &lt;span class="n">trainData[&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="m">-1&lt;/span>&lt;span class="n">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">y_train&lt;/span> &lt;span class="o">&amp;lt;-&lt;/span> &lt;span class="n">trainData[&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="m">1&lt;/span>&lt;span class="n">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">testData&lt;/span> &lt;span class="o">&amp;lt;-&lt;/span> &lt;span class="n">mdat[&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="n">trainIndex&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">X_test&lt;/span> &lt;span class="o">&amp;lt;-&lt;/span> &lt;span class="n">testData[&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="m">-1&lt;/span>&lt;span class="n">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">y_test&lt;/span> &lt;span class="o">&amp;lt;-&lt;/span> &lt;span class="n">testData[&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="m">1&lt;/span>&lt;span class="n">]&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="building-model">Building model&lt;/h2>
&lt;p>fitting model with default using &lt;code>randomForest&lt;/code> based on trainData set.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-r" data-lang="r">&lt;span class="line">&lt;span class="cl">&lt;span class="nf">set.seed&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="m">123&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">rf_fit&lt;/span> &lt;span class="o">&amp;lt;-&lt;/span> &lt;span class="nf">randomForest&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">Group&lt;/span> &lt;span class="o">~&lt;/span> &lt;span class="n">.,&lt;/span> &lt;span class="n">data&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">trainData&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">importance&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="kc">TRUE&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">proximity&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="kc">TRUE&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">rf_fit&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-markdown" data-lang="markdown">&lt;span class="line">&lt;span class="cl">Call:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> randomForest(formula = Group ~ ., data = trainData, importance = TRUE, proximity = TRUE)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> Type of random forest: classification
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> Number of trees: 500
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">No. of variables tried at each split: 5
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> OOB estimate of error rate: 4.26%
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Confusion matrix:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> B M class.error
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">B 241 9 0.03600000
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">M 8 141 0.05369128
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>The &lt;em>OOB estimate of error rate&lt;/em> is &lt;strong>4.26%&lt;/strong>, indicating the Accuracy of this RF model is &lt;strong>95.74%&lt;/strong>.&lt;/p>
&lt;h2 id="biomarkers-ordered-by-meandecreaseaccuracy">Biomarkers ordered by MeanDecreaseAccuracy&lt;/h2>
&lt;p>Ordering the features&amp;rsquo; importance by &lt;code>MeanDecreaseAccuracy&lt;/code>.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-r" data-lang="r">&lt;span class="line">&lt;span class="cl">&lt;span class="n">imp_biomarker&lt;/span> &lt;span class="o">&amp;lt;-&lt;/span> &lt;span class="n">tibble&lt;/span>&lt;span class="o">::&lt;/span>&lt;span class="nf">as_tibble&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nf">round&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nf">importance&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">rf_fit&lt;/span>&lt;span class="p">),&lt;/span> &lt;span class="m">2&lt;/span>&lt;span class="p">),&lt;/span> &lt;span class="n">rownames&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s">&amp;#34;Features&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">%&amp;gt;%&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">dplyr&lt;/span>&lt;span class="o">::&lt;/span>&lt;span class="nf">arrange&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nf">desc&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">MeanDecreaseAccuracy&lt;/span>&lt;span class="p">))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nf">head&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">imp_biomarker&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-markdown" data-lang="markdown">&lt;span class="line">&lt;span class="cl">&lt;span class="gh"># A tibble: 6 × 5
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="gh">&lt;/span> Features B M MeanDecreaseAccuracy MeanDecreaseGini
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">&amp;lt;&lt;/span>&lt;span class="nt">chr&lt;/span>&lt;span class="p">&amp;gt;&lt;/span> &lt;span class="p">&amp;lt;&lt;/span>&lt;span class="nt">dbl&lt;/span>&lt;span class="p">&amp;gt;&lt;/span> &lt;span class="p">&amp;lt;&lt;/span>&lt;span class="nt">dbl&lt;/span>&lt;span class="p">&amp;gt;&lt;/span> &lt;span class="p">&amp;lt;&lt;/span>&lt;span class="nt">dbl&lt;/span>&lt;span class="p">&amp;gt;&lt;/span> &lt;span class="p">&amp;lt;&lt;/span>&lt;span class="nt">dbl&lt;/span>&lt;span class="p">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">1 concave.points_worst 14.6 12.5 18.0 24.0
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">2 perimeter_worst 13.7 11.6 16.2 26.8
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">3 radius_worst 13.1 11.4 16.1 21.2
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">4 area_worst 11.9 10.5 14.5 20.5
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">5 concavity_worst 8.94 9.74 13.3 6.46
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">6 texture_worst 8.27 10.6 12.9 3.27
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;code>MeanDecreaseAccuracy&lt;/code> shows that the contribution of the features. For exmple, removing &lt;em>concave.points_worst&lt;/em> would decrease the accuracy by &lt;strong>18.0%&lt;/strong>. The higher the &lt;code>MeanDecreaseAccuracy&lt;/code> of the features, the more they contribute to the model.&lt;/p>
&lt;h2 id="cross-validation">Cross validation&lt;/h2>
&lt;p>5 replicates for the 5-folds cross-validation to obtain the mean error in order to avoid the over-fitting and under-fitting. Meanwhile, the optimal number of features is selected according to the number with the mean error.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-r" data-lang="r">&lt;span class="line">&lt;span class="cl">&lt;span class="n">error.cv&lt;/span> &lt;span class="o">&amp;lt;-&lt;/span> &lt;span class="nf">c&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nf">for &lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">i&lt;/span> &lt;span class="n">in&lt;/span> &lt;span class="m">1&lt;/span>&lt;span class="o">:&lt;/span>&lt;span class="m">5&lt;/span>&lt;span class="p">){&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nf">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">i&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nf">set.seed&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">i&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">fit&lt;/span> &lt;span class="o">&amp;lt;-&lt;/span> &lt;span class="nf">rfcv&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">trainx&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">X_train&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">trainy&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">y_train&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">cv.fold&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="m">5&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">scale&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s">&amp;#34;log&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">step&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="m">0.9&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">error.cv&lt;/span> &lt;span class="o">&amp;lt;-&lt;/span> &lt;span class="nf">cbind&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">error.cv&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">fit&lt;/span>&lt;span class="o">$&lt;/span>&lt;span class="n">error.cv&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">n.var&lt;/span> &lt;span class="o">&amp;lt;-&lt;/span> &lt;span class="nf">as.numeric&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nf">rownames&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">error.cv&lt;/span>&lt;span class="p">))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nf">colnames&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">error.cv&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">&amp;lt;-&lt;/span> &lt;span class="nf">paste&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#39;error&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="m">1&lt;/span>&lt;span class="o">:&lt;/span>&lt;span class="m">5&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">sep&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s">&amp;#39;.&amp;#39;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">err.mean&lt;/span> &lt;span class="o">&amp;lt;-&lt;/span> &lt;span class="nf">apply&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">error.cv&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="m">1&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">mean&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">err.df&lt;/span> &lt;span class="o">&amp;lt;-&lt;/span> &lt;span class="nf">data.frame&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">num&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">n.var&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">err.mean&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">err.mean&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">error.cv&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nf">head&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">err.df[&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="m">1&lt;/span>&lt;span class="o">:&lt;/span>&lt;span class="m">6&lt;/span>&lt;span class="n">]&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-markdown" data-lang="markdown">&lt;span class="line">&lt;span class="cl"> num err.mean error.1 error.2 error.3 error.4
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">30 30 0.04110276 0.03759398 0.04260652 0.04260652 0.04260652
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">27 27 0.04160401 0.04010025 0.04010025 0.04761905 0.04010025
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">24 24 0.04260652 0.04260652 0.04260652 0.04260652 0.04761905
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">22 22 0.04360902 0.04260652 0.04260652 0.04511278 0.04511278
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">20 20 0.04210526 0.04260652 0.04511278 0.04260652 0.04260652
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">18 18 0.04060150 0.04260652 0.04260652 0.04010025 0.04260652
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;ul>
&lt;li>optimal number of biomarkers chosen by min cv.error&lt;/li>
&lt;/ul>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-r" data-lang="r">&lt;span class="line">&lt;span class="cl">&lt;span class="n">optimal&lt;/span> &lt;span class="o">&amp;lt;-&lt;/span> &lt;span class="n">err.df&lt;/span>&lt;span class="o">$&lt;/span>&lt;span class="n">num&lt;/span>&lt;span class="nf">[which&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">err.df&lt;/span>&lt;span class="o">$&lt;/span>&lt;span class="n">err.mean&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="nf">min&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">err.df&lt;/span>&lt;span class="o">$&lt;/span>&lt;span class="n">err.mean&lt;/span>&lt;span class="p">))&lt;/span>&lt;span class="n">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">main_theme&lt;/span> &lt;span class="o">&amp;lt;-&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nf">theme&lt;/span>&lt;span class="p">(&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">panel.background&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nf">element_blank&lt;/span>&lt;span class="p">(),&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">panel.grid&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nf">element_blank&lt;/span>&lt;span class="p">(),&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">axis.line.x&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nf">element_line&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">linewidth&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="m">0.5&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">color&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s">&amp;#34;black&amp;#34;&lt;/span>&lt;span class="p">),&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">axis.line.y&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nf">element_line&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">linewidth&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="m">0.5&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">color&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s">&amp;#34;black&amp;#34;&lt;/span>&lt;span class="p">),&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">axis.ticks&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nf">element_line&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">color&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s">&amp;#34;black&amp;#34;&lt;/span>&lt;span class="p">),&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">axis.text&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nf">element_text&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">color&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s">&amp;#34;black&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">size&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="m">12&lt;/span>&lt;span class="p">),&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">legend.position&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s">&amp;#34;right&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">legend.background&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nf">element_blank&lt;/span>&lt;span class="p">(),&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">legend.key&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nf">element_blank&lt;/span>&lt;span class="p">(),&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">legend.text&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nf">element_text&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">size&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="m">12&lt;/span>&lt;span class="p">),&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">text&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nf">element_text&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">family&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s">&amp;#34;sans&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">size&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="m">12&lt;/span>&lt;span class="p">))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">pl&lt;/span> &lt;span class="o">&amp;lt;-&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nf">ggplot&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">data&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">err.df&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nf">aes&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">x&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">err.df&lt;/span>&lt;span class="o">$&lt;/span>&lt;span class="n">num&lt;/span>&lt;span class="p">))&lt;/span> &lt;span class="o">+&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nf">geom_line&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nf">aes&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">y&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">err.df&lt;/span>&lt;span class="o">$&lt;/span>&lt;span class="n">error.1&lt;/span>&lt;span class="p">),&lt;/span> &lt;span class="n">color&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s">&amp;#39;grey&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">size&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="m">0.5&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">+&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nf">geom_line&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nf">aes&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">y&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">err.df&lt;/span>&lt;span class="o">$&lt;/span>&lt;span class="n">error.2&lt;/span>&lt;span class="p">),&lt;/span> &lt;span class="n">color&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s">&amp;#39;grey&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">size&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="m">0.5&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">+&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nf">geom_line&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nf">aes&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">y&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">err.df&lt;/span>&lt;span class="o">$&lt;/span>&lt;span class="n">error.3&lt;/span>&lt;span class="p">),&lt;/span> &lt;span class="n">color&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s">&amp;#39;grey&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">size&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="m">0.5&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">+&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nf">geom_line&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nf">aes&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">y&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">err.df&lt;/span>&lt;span class="o">$&lt;/span>&lt;span class="n">error.4&lt;/span>&lt;span class="p">),&lt;/span> &lt;span class="n">color&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s">&amp;#39;grey&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">size&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="m">0.5&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">+&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nf">geom_line&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nf">aes&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">y&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">err.df&lt;/span>&lt;span class="o">$&lt;/span>&lt;span class="n">error.5&lt;/span>&lt;span class="p">),&lt;/span> &lt;span class="n">color&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s">&amp;#39;grey&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">size&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="m">0.5&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">+&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nf">geom_line&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nf">aes&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">y&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">err.df&lt;/span>&lt;span class="o">$&lt;/span>&lt;span class="n">err.mean&lt;/span>&lt;span class="p">),&lt;/span> &lt;span class="n">color&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s">&amp;#39;black&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">size&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="m">0.5&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">+&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nf">geom_vline&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">xintercept&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">optimal&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">color&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s">&amp;#39;red&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">lwd&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="m">0.36&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">linetype&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="m">2&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">+&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nf">coord_trans&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">x&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s">&amp;#34;log2&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">+&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nf">scale_x_continuous&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">breaks&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nf">c&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="m">1&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="m">5&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="m">10&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="m">20&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="m">30&lt;/span>&lt;span class="p">))&lt;/span> &lt;span class="o">+&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nf">labs&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">x&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s">&amp;#39;Number of Species &amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">y&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s">&amp;#39;Cross-validation error rate&amp;#39;&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">+&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nf">annotate&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;text&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">x&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">optimal&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">y&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nf">max&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">err.df&lt;/span>&lt;span class="o">$&lt;/span>&lt;span class="n">err.mean&lt;/span>&lt;span class="p">),&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">label&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nf">paste&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;Optimal = &amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">optimal&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">sep&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s">&amp;#34;&amp;#34;&lt;/span>&lt;span class="p">),&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">color&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s">&amp;#34;red&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">+&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">main_theme&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">pl&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>
&lt;figure >
&lt;div class="d-flex justify-content-center">
&lt;div class="w-100" >&lt;img src="https://raw.githubusercontent.com/HuaZou/Image_Host/main/img/image-20230427111833709.png" alt="" loading="lazy" data-zoomable />&lt;/div>
&lt;/div>&lt;/figure>
&lt;/p>
&lt;p>Since the figure shows that the model had a minimum error rate when the number of features was &lt;strong>18&lt;/strong>, the optimal number of biomarkers is &lt;strong>18&lt;/strong>.&lt;/p>
&lt;ul>
&lt;li>importance of optimal biomarker&lt;/li>
&lt;/ul>
&lt;p>Displaying the &lt;code>MeanDecreaseAccuracy&lt;/code> of the best biomarkers&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-r" data-lang="r">&lt;span class="line">&lt;span class="cl">&lt;span class="n">imp_biomarker[1&lt;/span>&lt;span class="o">:&lt;/span>&lt;span class="n">optimal&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">]&lt;/span> &lt;span class="o">%&amp;gt;%&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">dplyr&lt;/span>&lt;span class="o">::&lt;/span>&lt;span class="nf">select&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">Features&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">MeanDecreaseAccuracy&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">%&amp;gt;%&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">dplyr&lt;/span>&lt;span class="o">::&lt;/span>&lt;span class="nf">arrange&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">MeanDecreaseAccuracy&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">%&amp;gt;%&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">dplyr&lt;/span>&lt;span class="o">::&lt;/span>&lt;span class="nf">mutate&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">Features&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">forcats&lt;/span>&lt;span class="o">::&lt;/span>&lt;span class="nf">fct_inorder&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">Features&lt;/span>&lt;span class="p">))&lt;/span> &lt;span class="o">%&amp;gt;%&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nf">ggplot&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nf">aes&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">x&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">Features&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">y&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">MeanDecreaseAccuracy&lt;/span>&lt;span class="p">))&lt;/span>&lt;span class="o">+&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nf">geom_bar&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">stat&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s">&amp;#34;identity&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">fill&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s">&amp;#34;white&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">color&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s">&amp;#34;blue&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">+&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nf">labs&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">x&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s">&amp;#34;&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">y&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s">&amp;#34;Mean decrease accuracy&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">+&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nf">coord_flip&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="o">+&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">main_theme&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>
&lt;figure >
&lt;div class="d-flex justify-content-center">
&lt;div class="w-100" >&lt;img src="https://raw.githubusercontent.com/HuaZou/Image_Host/main/img/image-20230427105252101.png" alt="" loading="lazy" data-zoomable />&lt;/div>
&lt;/div>&lt;/figure>
&lt;/p>
&lt;h2 id="rebuilding-model-by-the-optimal-biomarkers">Rebuilding model by the optimal biomarkers&lt;/h2>
&lt;p>Here, we used the new candidates to rebuild the RF model, and the accuracy of the new model increased by 0.5% (the OOB error rate decreased from 4.26% to 3.76%).&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-r" data-lang="r">&lt;span class="line">&lt;span class="cl">&lt;span class="n">selected_columns&lt;/span> &lt;span class="o">&amp;lt;-&lt;/span> &lt;span class="nf">c&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;Group&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">imp_biomarker[1&lt;/span>&lt;span class="o">:&lt;/span>&lt;span class="n">optimal&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">]&lt;/span>&lt;span class="o">$&lt;/span>&lt;span class="n">Features&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">trainData_optimal&lt;/span> &lt;span class="o">&amp;lt;-&lt;/span> &lt;span class="n">trainData&lt;/span> &lt;span class="o">%&amp;gt;%&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">dplyr&lt;/span>&lt;span class="o">::&lt;/span>&lt;span class="nf">select&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nf">all_of&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">selected_columns&lt;/span>&lt;span class="p">))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">testData_optimal&lt;/span> &lt;span class="o">&amp;lt;-&lt;/span> &lt;span class="n">testData&lt;/span> &lt;span class="o">%&amp;gt;%&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">dplyr&lt;/span>&lt;span class="o">::&lt;/span>&lt;span class="nf">select&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nf">all_of&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">selected_columns&lt;/span>&lt;span class="p">))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nf">set.seed&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="m">123&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">rf_fit_optimal&lt;/span> &lt;span class="o">&amp;lt;-&lt;/span> &lt;span class="nf">randomForest&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">Group&lt;/span> &lt;span class="o">~&lt;/span> &lt;span class="n">.,&lt;/span> &lt;span class="n">data&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">trainData_optimal&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">importance&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="kc">TRUE&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">proximity&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="kc">TRUE&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">rf_fit_optimal&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-markdown" data-lang="markdown">&lt;span class="line">&lt;span class="cl">Call:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> randomForest(formula = Group ~ ., data = trainData_optimal, importance = TRUE, proximity = TRUE)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> Type of random forest: classification
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> Number of trees: 500
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">No. of variables tried at each split: 4
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> OOB estimate of error rate: 3.76%
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Confusion matrix:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> B M class.error
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">B 242 8 0.03200000
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">M 7 142 0.04697987
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;ul>
&lt;li>ConfusionMatrix&lt;/li>
&lt;/ul>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-r" data-lang="r">&lt;span class="line">&lt;span class="cl">&lt;span class="n">group_names&lt;/span> &lt;span class="o">&amp;lt;-&lt;/span> &lt;span class="nf">c&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;B&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;M&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">pred_raw&lt;/span> &lt;span class="o">&amp;lt;-&lt;/span> &lt;span class="nf">predict&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">rf_fit_optimal&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">newdata&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">testData_optimal&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">type&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s">&amp;#34;response&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nf">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">caret&lt;/span>&lt;span class="o">::&lt;/span>&lt;span class="nf">confusionMatrix&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">pred_raw&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">testData_optimal&lt;/span>&lt;span class="o">$&lt;/span>&lt;span class="n">Group&lt;/span>&lt;span class="p">))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">pred_prob&lt;/span> &lt;span class="o">&amp;lt;-&lt;/span> &lt;span class="nf">predict&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">rf_fit_optimal&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">newdata&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">testData_optimal&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">type&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s">&amp;#34;prob&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-markdown" data-lang="markdown">&lt;span class="line">&lt;span class="cl">Confusion Matrix and Statistics
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> Reference
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Prediction B M
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> B 105 3
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> M 2 60
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> Accuracy : 0.9706
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> 95% CI : (0.9327, 0.9904)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> No Information Rate : 0.6294
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> P-Value [Acc &amp;gt; NIR] : &lt;span class="p">&amp;lt;&lt;/span>&lt;span class="nt">2e-16&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="na">Kappa&lt;/span> &lt;span class="na">:&lt;/span> &lt;span class="na">0&lt;/span>&lt;span class="err">.&lt;/span>&lt;span class="na">9367&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="na">Mcnemar&lt;/span>&lt;span class="err">&amp;#39;&lt;/span>&lt;span class="na">s&lt;/span> &lt;span class="na">Test&lt;/span> &lt;span class="na">P-Value&lt;/span> &lt;span class="na">:&lt;/span> &lt;span class="na">1&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="na">Sensitivity&lt;/span> &lt;span class="na">:&lt;/span> &lt;span class="na">0&lt;/span>&lt;span class="err">.&lt;/span>&lt;span class="na">9813&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="na">Specificity&lt;/span> &lt;span class="na">:&lt;/span> &lt;span class="na">0&lt;/span>&lt;span class="err">.&lt;/span>&lt;span class="na">9524&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="na">Pos&lt;/span> &lt;span class="na">Pred&lt;/span> &lt;span class="na">Value&lt;/span> &lt;span class="na">:&lt;/span> &lt;span class="na">0&lt;/span>&lt;span class="err">.&lt;/span>&lt;span class="na">9722&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="na">Neg&lt;/span> &lt;span class="na">Pred&lt;/span> &lt;span class="na">Value&lt;/span> &lt;span class="na">:&lt;/span> &lt;span class="na">0&lt;/span>&lt;span class="err">.&lt;/span>&lt;span class="na">9677&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="na">Prevalence&lt;/span> &lt;span class="na">:&lt;/span> &lt;span class="na">0&lt;/span>&lt;span class="err">.&lt;/span>&lt;span class="na">6294&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="na">Detection&lt;/span> &lt;span class="na">Rate&lt;/span> &lt;span class="na">:&lt;/span> &lt;span class="na">0&lt;/span>&lt;span class="err">.&lt;/span>&lt;span class="na">6176&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="na">Detection&lt;/span> &lt;span class="na">Prevalence&lt;/span> &lt;span class="na">:&lt;/span> &lt;span class="na">0&lt;/span>&lt;span class="err">.&lt;/span>&lt;span class="na">6353&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="na">Balanced&lt;/span> &lt;span class="na">Accuracy&lt;/span> &lt;span class="na">:&lt;/span> &lt;span class="na">0&lt;/span>&lt;span class="err">.&lt;/span>&lt;span class="na">9668&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="err">&amp;#39;&lt;/span>&lt;span class="na">Positive&lt;/span>&lt;span class="err">&amp;#39;&lt;/span> &lt;span class="na">Class&lt;/span> &lt;span class="na">:&lt;/span> &lt;span class="na">B&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;ul>
&lt;li>performance of classifier&lt;/li>
&lt;/ul>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-r" data-lang="r">&lt;span class="line">&lt;span class="cl">&lt;span class="n">Evaluate_index&lt;/span> &lt;span class="o">&amp;lt;-&lt;/span> &lt;span class="nf">function&lt;/span>&lt;span class="p">(&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">DataTest&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">PredProb&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">pred_prob&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">label&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">group_names[1]&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">PredRaw&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">pred_raw&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1"># DataTest = testData&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1"># PredProb = pred_prob&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1"># label = group_names[1]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1"># PredRaw = pred_raw&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1"># ROC object&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">rocobj&lt;/span> &lt;span class="o">&amp;lt;-&lt;/span> &lt;span class="nf">roc&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">DataTest&lt;/span>&lt;span class="o">$&lt;/span>&lt;span class="n">Group&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">PredProb[&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="m">1&lt;/span>&lt;span class="n">]&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1"># confusionMatrix&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">con_matrix&lt;/span> &lt;span class="o">&amp;lt;-&lt;/span> &lt;span class="nf">table&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">PredRaw&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">DataTest&lt;/span>&lt;span class="o">$&lt;/span>&lt;span class="n">Group&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1"># index&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">TP&lt;/span> &lt;span class="o">&amp;lt;-&lt;/span> &lt;span class="n">con_matrix[1&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="m">1&lt;/span>&lt;span class="n">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">FN&lt;/span> &lt;span class="o">&amp;lt;-&lt;/span> &lt;span class="n">con_matrix[2&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="m">1&lt;/span>&lt;span class="n">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">FP&lt;/span> &lt;span class="o">&amp;lt;-&lt;/span> &lt;span class="n">con_matrix[1&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="m">2&lt;/span>&lt;span class="n">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">TN&lt;/span> &lt;span class="o">&amp;lt;-&lt;/span> &lt;span class="n">con_matrix[2&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="m">2&lt;/span>&lt;span class="n">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">rocbj_df&lt;/span> &lt;span class="o">&amp;lt;-&lt;/span> &lt;span class="nf">data.frame&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">threshold&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nf">round&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">rocobj&lt;/span>&lt;span class="o">$&lt;/span>&lt;span class="n">thresholds&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="m">3&lt;/span>&lt;span class="p">),&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">sensitivities&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nf">round&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">rocobj&lt;/span>&lt;span class="o">$&lt;/span>&lt;span class="n">sensitivities&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="m">3&lt;/span>&lt;span class="p">),&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">specificities&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nf">round&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">rocobj&lt;/span>&lt;span class="o">$&lt;/span>&lt;span class="n">specificities&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="m">3&lt;/span>&lt;span class="p">),&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">value&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">rocobj&lt;/span>&lt;span class="o">$&lt;/span>&lt;span class="n">sensitivities&lt;/span> &lt;span class="o">+&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">rocobj&lt;/span>&lt;span class="o">$&lt;/span>&lt;span class="n">specificities&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">max_value_row&lt;/span> &lt;span class="o">&amp;lt;-&lt;/span> &lt;span class="nf">which&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nf">max&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">rocbj_df&lt;/span>&lt;span class="o">$&lt;/span>&lt;span class="n">value&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="n">rocbj_df&lt;/span>&lt;span class="o">$&lt;/span>&lt;span class="n">value&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="n">[1]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">threshold&lt;/span> &lt;span class="o">&amp;lt;-&lt;/span> &lt;span class="n">rocbj_df&lt;/span>&lt;span class="o">$&lt;/span>&lt;span class="n">threshold[max_value_row]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">sen&lt;/span> &lt;span class="o">&amp;lt;-&lt;/span> &lt;span class="nf">round&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">TP&lt;/span> &lt;span class="o">/&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">TP&lt;/span> &lt;span class="o">+&lt;/span> &lt;span class="n">FN&lt;/span>&lt;span class="p">),&lt;/span> &lt;span class="m">3&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="c1"># caret::sensitivity(con_matrix)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">spe&lt;/span> &lt;span class="o">&amp;lt;-&lt;/span> &lt;span class="nf">round&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">TN&lt;/span> &lt;span class="o">/&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">TN&lt;/span> &lt;span class="o">+&lt;/span> &lt;span class="n">FP&lt;/span>&lt;span class="p">),&lt;/span> &lt;span class="m">3&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="c1"># caret::specificity(con_matrix)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">acc&lt;/span> &lt;span class="o">&amp;lt;-&lt;/span> &lt;span class="nf">round&lt;/span>&lt;span class="p">((&lt;/span>&lt;span class="n">TP&lt;/span> &lt;span class="o">+&lt;/span> &lt;span class="n">TN&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">/&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">TP&lt;/span> &lt;span class="o">+&lt;/span> &lt;span class="n">TN&lt;/span> &lt;span class="o">+&lt;/span> &lt;span class="n">FP&lt;/span> &lt;span class="o">+&lt;/span> &lt;span class="n">FN&lt;/span>&lt;span class="p">),&lt;/span> &lt;span class="m">3&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="c1"># Accuracy&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">pre&lt;/span> &lt;span class="o">&amp;lt;-&lt;/span> &lt;span class="nf">round&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">TP&lt;/span> &lt;span class="o">/&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">TP&lt;/span> &lt;span class="o">+&lt;/span> &lt;span class="n">FP&lt;/span>&lt;span class="p">),&lt;/span> &lt;span class="m">3&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="c1"># precision&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">rec&lt;/span> &lt;span class="o">&amp;lt;-&lt;/span> &lt;span class="nf">round&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">TP&lt;/span> &lt;span class="o">/&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">TP&lt;/span> &lt;span class="o">+&lt;/span> &lt;span class="n">FN&lt;/span>&lt;span class="p">),&lt;/span> &lt;span class="m">3&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="c1"># recall&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">#F1S &amp;lt;- round(2 * TP / (TP + TN + FP + FN + TP - TN), 3)# F1-Score&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">F1S&lt;/span> &lt;span class="o">&amp;lt;-&lt;/span> &lt;span class="nf">round&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="m">2&lt;/span> &lt;span class="o">*&lt;/span> &lt;span class="n">TP&lt;/span> &lt;span class="o">/&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="m">2&lt;/span> &lt;span class="o">*&lt;/span> &lt;span class="n">TP&lt;/span> &lt;span class="o">+&lt;/span> &lt;span class="n">FP&lt;/span> &lt;span class="o">+&lt;/span> &lt;span class="n">FN&lt;/span>&lt;span class="p">),&lt;/span> &lt;span class="m">3&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="c1"># F1-Score&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">youden&lt;/span> &lt;span class="o">&amp;lt;-&lt;/span> &lt;span class="n">sen&lt;/span> &lt;span class="o">+&lt;/span> &lt;span class="n">spe&lt;/span> &lt;span class="o">-&lt;/span> &lt;span class="m">1&lt;/span> &lt;span class="c1"># youden index&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">index_df&lt;/span> &lt;span class="o">&amp;lt;-&lt;/span> &lt;span class="nf">data.frame&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">Index&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nf">c&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;Threshold&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;Sensitivity&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s">&amp;#34;Specificity&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;Accuracy&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s">&amp;#34;Precision&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;Recall&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s">&amp;#34;F1 Score&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;Youden index&amp;#34;&lt;/span>&lt;span class="p">),&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">Value&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nf">c&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">threshold&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">sen&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">spe&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">acc&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">pre&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">rec&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">F1S&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">youden&lt;/span>&lt;span class="p">))&lt;/span> &lt;span class="o">%&amp;gt;%&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">stats&lt;/span>&lt;span class="o">::&lt;/span>&lt;span class="nf">setNames&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nf">c&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;Index&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">label&lt;/span>&lt;span class="p">))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nf">return&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">index_df&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nf">Evaluate_index&lt;/span>&lt;span class="p">(&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">DataTest&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">testData&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">PredProb&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">pred_prob&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">label&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">group_names[1]&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">PredRaw&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">pred_raw&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-markdown" data-lang="markdown">&lt;span class="line">&lt;span class="cl"> Index B
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">1 Threshold 0.556
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">2 Sensitivity 0.981
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">3 Specificity 0.952
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">4 Accuracy 0.971
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">5 Precision 0.972
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">6 Recall 0.981
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">7 F1 Score 0.977
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">8 Youden index 0.933
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;ul>
&lt;li>AUROC&lt;/li>
&lt;/ul>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-r" data-lang="r">&lt;span class="line">&lt;span class="cl">&lt;span class="n">AUROC&lt;/span> &lt;span class="o">&amp;lt;-&lt;/span> &lt;span class="nf">function&lt;/span>&lt;span class="p">(&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">DataTest&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">PredProb&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">pred_prob&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">label&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">group_names[1]&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">DataProf&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">profile&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1"># ROC object&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">rocobj&lt;/span> &lt;span class="o">&amp;lt;-&lt;/span> &lt;span class="nf">roc&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">DataTest&lt;/span>&lt;span class="o">$&lt;/span>&lt;span class="n">Group&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">PredProb[&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="m">1&lt;/span>&lt;span class="n">]&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1"># Youden index: cutoff point&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1"># plot(rocobj,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1"># legacy.axes = TRUE,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1"># of = &amp;#34;thresholds&amp;#34;, &lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1"># thresholds = &amp;#34;best&amp;#34;, &lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1"># print.thres=&amp;#34;best&amp;#34;)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1"># AUROC data&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">roc&lt;/span> &lt;span class="o">&amp;lt;-&lt;/span> &lt;span class="nf">data.frame&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">tpr&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">rocobj&lt;/span>&lt;span class="o">$&lt;/span>&lt;span class="n">sensitivities&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">fpr&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="m">1&lt;/span> &lt;span class="o">-&lt;/span> &lt;span class="n">rocobj&lt;/span>&lt;span class="o">$&lt;/span>&lt;span class="n">specificities&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1"># AUC 95% CI&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">rocobj_CI&lt;/span> &lt;span class="o">&amp;lt;-&lt;/span> &lt;span class="nf">roc&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">DataTest&lt;/span>&lt;span class="o">$&lt;/span>&lt;span class="n">Group&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">PredProb[&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="m">1&lt;/span>&lt;span class="n">]&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">ci&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="kc">TRUE&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">percent&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="kc">TRUE&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">roc_CI&lt;/span> &lt;span class="o">&amp;lt;-&lt;/span> &lt;span class="nf">round&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nf">as.numeric&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">rocobj_CI&lt;/span>&lt;span class="o">$&lt;/span>&lt;span class="n">ci&lt;/span>&lt;span class="p">)&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="m">100&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="m">3&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">roc_CI_lab&lt;/span> &lt;span class="o">&amp;lt;-&lt;/span> &lt;span class="nf">paste0&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">label&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s">&amp;#34; (&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;AUC=&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">roc_CI[2]&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s">&amp;#34;, 95%CI &amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">roc_CI[1]&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;-&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">roc_CI[3]&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s">&amp;#34;)&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1"># ROC dataframe&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">rocbj_df&lt;/span> &lt;span class="o">&amp;lt;-&lt;/span> &lt;span class="nf">data.frame&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">threshold&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nf">round&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">rocobj&lt;/span>&lt;span class="o">$&lt;/span>&lt;span class="n">thresholds&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="m">3&lt;/span>&lt;span class="p">),&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">sensitivities&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nf">round&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">rocobj&lt;/span>&lt;span class="o">$&lt;/span>&lt;span class="n">sensitivities&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="m">3&lt;/span>&lt;span class="p">),&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">specificities&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nf">round&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">rocobj&lt;/span>&lt;span class="o">$&lt;/span>&lt;span class="n">specificities&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="m">3&lt;/span>&lt;span class="p">),&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">value&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">rocobj&lt;/span>&lt;span class="o">$&lt;/span>&lt;span class="n">sensitivities&lt;/span> &lt;span class="o">+&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">rocobj&lt;/span>&lt;span class="o">$&lt;/span>&lt;span class="n">specificities&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">max_value_row&lt;/span> &lt;span class="o">&amp;lt;-&lt;/span> &lt;span class="nf">which&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="nf">max&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">rocbj_df&lt;/span>&lt;span class="o">$&lt;/span>&lt;span class="n">value&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">==&lt;/span> &lt;span class="n">rocbj_df&lt;/span>&lt;span class="o">$&lt;/span>&lt;span class="n">value&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">threshold&lt;/span> &lt;span class="o">&amp;lt;-&lt;/span> &lt;span class="n">rocbj_df&lt;/span>&lt;span class="o">$&lt;/span>&lt;span class="n">threshold[max_value_row]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1"># plot&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">pl&lt;/span> &lt;span class="o">&amp;lt;-&lt;/span> &lt;span class="nf">ggplot&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">data&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">roc&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nf">aes&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">x&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">fpr&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">y&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">tpr&lt;/span>&lt;span class="p">))&lt;/span> &lt;span class="o">+&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nf">geom_path&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">color&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s">&amp;#34;red&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">size&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="m">1&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">+&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nf">geom_abline&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">intercept&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="m">0&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">slope&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="m">1&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">color&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s">&amp;#34;grey&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">size&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="m">1&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">linetype&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="m">2&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">+&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nf">labs&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">x&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s">&amp;#34;False Positive Rate (1 - Specificity)&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">y&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s">&amp;#34;True Positive Rate&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">title&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nf">paste0&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;AUROC (&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">DataProf&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34; Features)&amp;#34;&lt;/span>&lt;span class="p">))&lt;/span> &lt;span class="o">+&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nf">annotate&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;text&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">x&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="m">1&lt;/span> &lt;span class="o">-&lt;/span> &lt;span class="n">rocbj_df&lt;/span>&lt;span class="o">$&lt;/span>&lt;span class="n">specificities[max_value_row]&lt;/span> &lt;span class="o">+&lt;/span> &lt;span class="m">0.15&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">y&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">rocbj_df&lt;/span>&lt;span class="o">$&lt;/span>&lt;span class="n">sensitivities[max_value_row]&lt;/span> &lt;span class="o">-&lt;/span> &lt;span class="m">0.05&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">label&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nf">paste0&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">threshold&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34; (&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">rocbj_df&lt;/span>&lt;span class="o">$&lt;/span>&lt;span class="n">specificities[max_value_row]&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;,&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">rocbj_df&lt;/span>&lt;span class="o">$&lt;/span>&lt;span class="n">sensitivities[max_value_row]&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;)&amp;#34;&lt;/span>&lt;span class="p">),&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">size&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="m">5&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">family&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s">&amp;#34;serif&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">+&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nf">annotate&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;point&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">x&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="m">1&lt;/span> &lt;span class="o">-&lt;/span> &lt;span class="n">rocbj_df&lt;/span>&lt;span class="o">$&lt;/span>&lt;span class="n">specificities[max_value_row]&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">y&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">rocbj_df&lt;/span>&lt;span class="o">$&lt;/span>&lt;span class="n">sensitivities[max_value_row]&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">color&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s">&amp;#34;black&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">size&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="m">2&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">+&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nf">annotate&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;text&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">x&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="m">.75&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">y&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="m">.25&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">label&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">roc_CI_lab&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">size&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="m">5&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">family&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s">&amp;#34;serif&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">+&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nf">coord_cartesian&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">xlim&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nf">c&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="m">0&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="m">1&lt;/span>&lt;span class="p">),&lt;/span> &lt;span class="n">ylim&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nf">c&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="m">0&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="m">1&lt;/span>&lt;span class="p">))&lt;/span> &lt;span class="o">+&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nf">theme_bw&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="o">+&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nf">theme&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">panel.background&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nf">element_rect&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">fill&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s">&amp;#34;transparent&amp;#34;&lt;/span>&lt;span class="p">),&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">plot.title&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nf">element_text&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">color&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s">&amp;#34;black&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">size&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="m">14&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">face&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s">&amp;#34;bold&amp;#34;&lt;/span>&lt;span class="p">),&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">axis.ticks.length&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nf">unit&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="m">0.4&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;lines&amp;#34;&lt;/span>&lt;span class="p">),&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">axis.ticks&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nf">element_line&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">color&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s">&amp;#34;black&amp;#34;&lt;/span>&lt;span class="p">),&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">axis.line&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nf">element_line&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">size&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="m">.5&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">color&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s">&amp;#34;black&amp;#34;&lt;/span>&lt;span class="p">),&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">axis.title&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nf">element_text&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">color&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s">&amp;#34;black&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">size&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="m">12&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">face&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s">&amp;#34;bold&amp;#34;&lt;/span>&lt;span class="p">),&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">axis.text&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nf">element_text&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">color&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s">&amp;#34;black&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">size&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="m">10&lt;/span>&lt;span class="p">),&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">text&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nf">element_text&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">size&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="m">8&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">color&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s">&amp;#34;black&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">family&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s">&amp;#34;serif&amp;#34;&lt;/span>&lt;span class="p">))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">res&lt;/span> &lt;span class="o">&amp;lt;-&lt;/span> &lt;span class="nf">list&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">rocobj&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">rocobj&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">roc_CI&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">roc_CI_lab&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">roc_pl&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">pl&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nf">return&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">res&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">AUROC_res&lt;/span> &lt;span class="o">&amp;lt;-&lt;/span> &lt;span class="nf">AUROC&lt;/span>&lt;span class="p">(&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">DataTest&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">testData&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">PredProb&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">pred_prob&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">label&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">group_names[1]&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">DataProf&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">optimal&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">AUROC_res&lt;/span>&lt;span class="o">$&lt;/span>&lt;span class="n">roc_pl&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>
&lt;figure >
&lt;div class="d-flex justify-content-center">
&lt;div class="w-100" >&lt;img src="https://raw.githubusercontent.com/HuaZou/Image_Host/main/img/image-20230427105553133.png" alt="" loading="lazy" data-zoomable />&lt;/div>
&lt;/div>&lt;/figure>
&lt;/p>
&lt;ul>
&lt;li>AUPRC&lt;/li>
&lt;/ul>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-r" data-lang="r">&lt;span class="line">&lt;span class="cl">&lt;span class="n">AUPRC&lt;/span> &lt;span class="o">&amp;lt;-&lt;/span> &lt;span class="nf">function&lt;/span>&lt;span class="p">(&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">DataTest&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">PredProb&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">pred_prob&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">DataProf&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">optimal&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1"># ROC object&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">rocobj&lt;/span> &lt;span class="o">&amp;lt;-&lt;/span> &lt;span class="nf">roc&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">DataTest&lt;/span>&lt;span class="o">$&lt;/span>&lt;span class="n">Group&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">PredProb[&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="m">1&lt;/span>&lt;span class="n">]&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1"># p-r value &lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">dat_PR&lt;/span> &lt;span class="o">&amp;lt;-&lt;/span> &lt;span class="nf">coords&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">rocobj&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;all&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">ret&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nf">c&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;precision&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;recall&amp;#34;&lt;/span>&lt;span class="p">))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1"># AUPRC data&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">prc&lt;/span> &lt;span class="o">&amp;lt;-&lt;/span> &lt;span class="nf">data.frame&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">precision&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">dat_PR&lt;/span>&lt;span class="o">$&lt;/span>&lt;span class="n">precision&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">recall&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">dat_PR&lt;/span>&lt;span class="o">$&lt;/span>&lt;span class="n">recall&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1"># plot&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">pl&lt;/span> &lt;span class="o">&amp;lt;-&lt;/span> &lt;span class="nf">ggplot&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">data&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">prc&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="nf">aes&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">x&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">recall&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">y&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">precision&lt;/span>&lt;span class="p">))&lt;/span> &lt;span class="o">+&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nf">geom_path&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">color&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s">&amp;#34;red&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">size&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="m">1&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">+&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nf">labs&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">x&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s">&amp;#34;Recall&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">y&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s">&amp;#34;Precision&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">title&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nf">paste0&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;AUPRC (&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">DataProf&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34; Features)&amp;#34;&lt;/span>&lt;span class="p">))&lt;/span> &lt;span class="o">+&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nf">coord_cartesian&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">xlim&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nf">c&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="m">0&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="m">1&lt;/span>&lt;span class="p">),&lt;/span> &lt;span class="n">ylim&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nf">c&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="m">0&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="m">1&lt;/span>&lt;span class="p">))&lt;/span> &lt;span class="o">+&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nf">theme_bw&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="o">+&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nf">theme&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">panel.background&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nf">element_rect&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">fill&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s">&amp;#34;transparent&amp;#34;&lt;/span>&lt;span class="p">),&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">plot.title&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nf">element_text&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">color&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s">&amp;#34;black&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">size&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="m">14&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">face&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s">&amp;#34;bold&amp;#34;&lt;/span>&lt;span class="p">),&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">axis.ticks.length&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nf">unit&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="m">0.4&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;lines&amp;#34;&lt;/span>&lt;span class="p">),&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">axis.ticks&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nf">element_line&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">color&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s">&amp;#34;black&amp;#34;&lt;/span>&lt;span class="p">),&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">axis.line&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nf">element_line&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">size&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="m">.5&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">color&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s">&amp;#34;black&amp;#34;&lt;/span>&lt;span class="p">),&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">axis.title&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nf">element_text&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">color&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s">&amp;#34;black&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">size&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="m">12&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">face&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s">&amp;#34;bold&amp;#34;&lt;/span>&lt;span class="p">),&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">axis.text&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nf">element_text&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">color&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s">&amp;#34;black&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">size&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="m">10&lt;/span>&lt;span class="p">),&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">text&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="nf">element_text&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">size&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="m">8&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">color&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s">&amp;#34;black&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">family&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s">&amp;#34;serif&amp;#34;&lt;/span>&lt;span class="p">))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">res&lt;/span> &lt;span class="o">&amp;lt;-&lt;/span> &lt;span class="nf">list&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">dat_PR&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">dat_PR&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">PC_pl&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">pl&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nf">return&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">res&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">AUPRC_res&lt;/span> &lt;span class="o">&amp;lt;-&lt;/span> &lt;span class="nf">AUPRC&lt;/span>&lt;span class="p">(&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">DataTest&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">testData&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">PredProb&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">pred_prob&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="n">DataProf&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">optimal&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">AUPRC_res&lt;/span>&lt;span class="o">$&lt;/span>&lt;span class="n">PC_pl&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>
&lt;figure >
&lt;div class="d-flex justify-content-center">
&lt;div class="w-100" >&lt;img src="https://raw.githubusercontent.com/HuaZou/Image_Host/main/img/image-20230427105628933.png" alt="" loading="lazy" data-zoomable />&lt;/div>
&lt;/div>&lt;/figure>
&lt;/p>
&lt;h2 id="systemic-information">systemic information&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-r" data-lang="r">&lt;span class="line">&lt;span class="cl">&lt;span class="n">devtools&lt;/span>&lt;span class="o">::&lt;/span>&lt;span class="nf">session_info&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-markdown" data-lang="markdown">&lt;span class="line">&lt;span class="cl">─ Session info ─────────────────────────────────────────────────────────────────────────────────────────────────────────
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> setting value
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> version R version 4.1.2 (2021-11-01)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> os macOS Monterey 12.2.1
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> system x86_64, darwin17.0
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> ui RStudio
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> language (EN)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> collate en_US.UTF-8
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> ctype en_US.UTF-8
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> tz Asia/Shanghai
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> date 2023-04-27
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> rstudio 2022.07.2+576 Spotted Wakerobin (desktop)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> pandoc 2.19.2 @ /Applications/RStudio.app/Contents/MacOS/quarto/bin/tools/ (via rmarkdown)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">─ Packages ─────────────────────────────────────────────────────────────────────────────────────────────────────────────
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> package * version date (UTC) lib source
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> assertthat 0.2.1 2019-03-21 [1] CRAN (R 4.1.0)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> blogdown 1.13.3 2022-11-01 [1] Github (rstudio/blogdown@5dddefa)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> brio 1.1.3 2021-11-30 [1] CRAN (R 4.1.0)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> cachem 1.0.6 2021-08-19 [1] CRAN (R 4.1.0)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> callr 3.7.0 2021-04-20 [1] CRAN (R 4.1.0)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> caret * 6.0-92 2022-04-19 [1] CRAN (R 4.1.2)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> class 7.3-20 2022-01-13 [1] CRAN (R 4.1.2)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> cli 3.4.1 2022-09-23 [1] CRAN (R 4.1.2)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> codetools 0.2-18 2020-11-04 [1] CRAN (R 4.1.2)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> colorspace 2.0-3 2022-02-21 [1] CRAN (R 4.1.2)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> crayon 1.5.0 2022-02-14 [1] CRAN (R 4.1.2)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> data.table * 1.14.6 2022-11-16 [1] CRAN (R 4.1.2)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> DBI 1.1.2 2021-12-20 [1] CRAN (R 4.1.0)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> desc 1.4.1 2022-03-06 [1] CRAN (R 4.1.2)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> devtools 2.4.3 2021-11-30 [1] CRAN (R 4.1.0)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> digest 0.6.30 2022-10-18 [1] CRAN (R 4.1.2)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> dplyr * 1.0.10 2022-09-01 [1] CRAN (R 4.1.2)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> e1071 1.7-9 2021-09-16 [1] CRAN (R 4.1.0)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> ellipsis 0.3.2 2021-04-29 [1] CRAN (R 4.1.0)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> evaluate 0.17 2022-10-07 [1] CRAN (R 4.1.2)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> fansi 1.0.2 2022-01-14 [1] CRAN (R 4.1.2)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> farver 2.1.0 2021-02-28 [1] CRAN (R 4.1.0)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> fastmap 1.1.0 2021-01-25 [1] CRAN (R 4.1.0)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> forcats 0.5.1 2021-01-27 [1] CRAN (R 4.1.0)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> foreach 1.5.2 2022-02-02 [1] CRAN (R 4.1.2)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> fs 1.5.2 2021-12-08 [1] CRAN (R 4.1.0)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> future 1.28.0 2022-09-02 [1] CRAN (R 4.1.2)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> future.apply 1.8.1 2021-08-10 [1] CRAN (R 4.1.0)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> generics 0.1.2 2022-01-31 [1] CRAN (R 4.1.2)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> ggplot2 * 3.4.0 2022-11-04 [1] CRAN (R 4.1.2)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> globals 0.16.1 2022-08-28 [1] CRAN (R 4.1.2)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> glue 1.6.2 2022-02-24 [1] CRAN (R 4.1.2)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> gower 1.0.0 2022-02-03 [1] CRAN (R 4.1.2)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> gtable 0.3.0 2019-03-25 [1] CRAN (R 4.1.0)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> hardhat 1.2.0 2022-06-30 [1] CRAN (R 4.1.2)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> htmltools 0.5.3 2022-07-18 [1] CRAN (R 4.1.2)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> ipred 0.9-12 2021-09-15 [1] CRAN (R 4.1.0)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> iterators 1.0.14 2022-02-05 [1] CRAN (R 4.1.2)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> jsonlite 1.8.3 2022-10-21 [1] CRAN (R 4.1.2)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> knitr 1.40 2022-08-24 [1] CRAN (R 4.1.2)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> labeling 0.4.2 2020-10-20 [1] CRAN (R 4.1.0)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> lattice * 0.20-45 2021-09-22 [1] CRAN (R 4.1.2)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> lava 1.6.10 2021-09-02 [1] CRAN (R 4.1.0)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> lifecycle 1.0.3 2022-10-07 [1] CRAN (R 4.1.2)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> listenv 0.8.0 2019-12-05 [1] CRAN (R 4.1.0)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> lubridate 1.8.0 2021-10-07 [1] CRAN (R 4.1.0)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> magrittr 2.0.3 2022-03-30 [1] CRAN (R 4.1.2)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> MASS 7.3-55 2022-01-13 [1] CRAN (R 4.1.2)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> Matrix 1.4-0 2021-12-08 [1] CRAN (R 4.1.0)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> memoise 2.0.1 2021-11-26 [1] CRAN (R 4.1.0)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> ModelMetrics 1.2.2.2 2020-03-17 [1] CRAN (R 4.1.0)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> munsell 0.5.0 2018-06-12 [1] CRAN (R 4.1.0)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> nlme 3.1-155 2022-01-13 [1] CRAN (R 4.1.2)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> nnet 7.3-17 2022-01-13 [1] CRAN (R 4.1.2)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> parallelly 1.32.1 2022-07-21 [1] CRAN (R 4.1.2)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> pillar 1.7.0 2022-02-01 [1] CRAN (R 4.1.2)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> pkgbuild 1.3.1 2021-12-20 [1] CRAN (R 4.1.0)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> pkgconfig 2.0.3 2019-09-22 [1] CRAN (R 4.1.0)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> pkgload 1.2.4 2021-11-30 [1] CRAN (R 4.1.0)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> plyr 1.8.6 2020-03-03 [1] CRAN (R 4.1.0)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> prettyunits 1.1.1 2020-01-24 [1] CRAN (R 4.1.0)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> pROC * 1.18.0 2021-09-03 [1] CRAN (R 4.1.0)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> processx 3.5.2 2021-04-30 [1] CRAN (R 4.1.0)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> prodlim 2019.11.13 2019-11-17 [1] CRAN (R 4.1.0)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> proxy 0.4-26 2021-06-07 [1] CRAN (R 4.1.0)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> ps 1.6.0 2021-02-28 [1] CRAN (R 4.1.0)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> purrr 0.3.4 2020-04-17 [1] CRAN (R 4.1.0)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> R6 2.5.1 2021-08-19 [1] CRAN (R 4.1.0)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> randomForest * 4.7-1 2022-02-03 [1] CRAN (R 4.1.2)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> Rcpp 1.0.10 2023-01-22 [1] CRAN (R 4.1.2)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> recipes 1.0.1 2022-07-07 [1] CRAN (R 4.1.2)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> remotes 2.4.2 2021-11-30 [1] CRAN (R 4.1.0)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> reshape2 1.4.4 2020-04-09 [1] CRAN (R 4.1.0)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> rlang 1.0.6 2022-09-24 [1] CRAN (R 4.1.2)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> rmarkdown 2.17 2022-10-07 [1] CRAN (R 4.1.2)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> rpart 4.1.16 2022-01-24 [1] CRAN (R 4.1.2)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> rprojroot 2.0.2 2020-11-15 [1] CRAN (R 4.1.0)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> rstudioapi 0.13 2020-11-12 [1] CRAN (R 4.1.0)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> scales 1.2.1 2022-08-20 [1] CRAN (R 4.1.2)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> sessioninfo 1.2.2 2021-12-06 [1] CRAN (R 4.1.0)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> stringi 1.7.8 2022-07-11 [1] CRAN (R 4.1.2)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> stringr 1.4.1 2022-08-20 [1] CRAN (R 4.1.2)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> survival 3.4-0 2022-08-09 [1] CRAN (R 4.1.2)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> testthat 3.1.2 2022-01-20 [1] CRAN (R 4.1.2)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> tibble * 3.1.8 2022-07-22 [1] CRAN (R 4.1.2)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> tidyselect 1.1.2 2022-02-21 [1] CRAN (R 4.1.2)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> timeDate 3043.102 2018-02-21 [1] CRAN (R 4.1.0)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> usethis 2.1.5 2021-12-09 [1] CRAN (R 4.1.0)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> utf8 1.2.2 2021-07-24 [1] CRAN (R 4.1.0)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> vctrs 0.5.1 2022-11-16 [1] CRAN (R 4.1.2)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> withr 2.5.0 2022-03-03 [1] CRAN (R 4.1.2)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> xfun 0.34 2022-10-18 [1] CRAN (R 4.1.2)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> yaml 2.3.6 2022-10-18 [1] CRAN (R 4.1.2)
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> [1] /Library/Frameworks/R.framework/Versions/4.1/Resources/library
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="summary">Summary&lt;/h2>
&lt;p>Random Forest classification with optimal features using R.&lt;/p>
&lt;ol>
&lt;li>Data partition.&lt;/li>
&lt;li>Features importance.&lt;/li>
&lt;li>Cross validation for OOB errors.&lt;/li>
&lt;li>The optimal features for rebuilding model.&lt;/li>
&lt;li>Performance Evaluation based on optimal features.&lt;/li>
&lt;li>Finalize results with AUROC and AUPRC etc.&lt;/li>
&lt;/ol>
&lt;h2 id="reference">Reference&lt;/h2>
&lt;ul>
&lt;li>&lt;a href="https://github.com/Jean-njoroge/Breast-cancer-risk-prediction/" target="_blank" rel="noopener">Breast-cancer-risk-prediction&lt;/a>&lt;/li>
&lt;/ul></description></item></channel></rss>