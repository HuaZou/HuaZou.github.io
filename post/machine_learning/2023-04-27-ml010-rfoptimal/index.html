<!doctype html><!-- This site was created with Wowchemy. https://www.wowchemy.com --><!-- Last Published: January 22, 2024 --><html lang=en-us><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=generator content="Wowchemy 5.7.0 for Hugo"><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=preload as=style href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Roboto+Mono&family=Roboto:wght@400;700&display=swap"><link rel=stylesheet href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Roboto+Mono&family=Roboto:wght@400;700&display=swap" media=print onload='this.media="all"'><link rel=stylesheet href=/css/vendor-bundle.min.16f785cdb553c8c4431db6775122af35.css media=print onload='this.media="all"'><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/academicons@1.9.2/css/academicons.min.css integrity="sha512-KlJCpRsLf+KKu2VQa5vmRuClRFjxc5lXO03ixZt82HZUk41+1I0bD8KBSA0fY290ayMfWYI9udIqeOWSu1/uZg==" crossorigin=anonymous media=print onload='this.media="all"'><link rel=stylesheet href=/css/wowchemy.e5d7adca760216d3b7e28ea434e81f6f.css><link rel=stylesheet href=/css/libs/chroma/github-light.min.css title=hl-light media=print onload='this.media="all"'><link rel=stylesheet href=/css/libs/chroma/dracula.min.css title=hl-dark media=print onload='this.media="all"' disabled><script async src="https://www.googletagmanager.com/gtag/js?id=UA-162525500-1"></script>
<script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}function trackOutboundLink(e,t){gtag("event","click",{event_category:"outbound",event_label:e,transport_type:"beacon",event_callback:function(){t!=="_blank"&&(document.location=e)}}),console.debug("Outbound link clicked: "+e)}function onClickCallback(e){if(e.target.tagName!=="A"||e.target.host===window.location.host)return;trackOutboundLink(e.target,e.target.getAttribute("target"))}gtag("js",new Date),gtag("config","UA-162525500-1",{}),gtag("set",{cookie_flags:"SameSite=None;Secure"}),document.addEventListener("click",onClickCallback,!1)</script><script>var _hmt=_hmt||[];(function(){var e,t=document.createElement("script");t.src="https://hm.baidu.com/hm.js?67583aee7371a754cff04fa0a471bca3",e=document.getElementsByTagName("script")[0],e.parentNode.insertBefore(t,e)})()</script><meta name=author content="Hua Zou"><meta name=description content="Selecting the optimal biomarkers in Random Forest."><link rel=alternate hreflang=en-us href=https://zouhua.top/post/machine_learning/2023-04-27-ml010-rfoptimal/><link rel=canonical href=https://zouhua.top/post/machine_learning/2023-04-27-ml010-rfoptimal/><link rel=manifest href=/manifest.webmanifest><link rel=icon type=image/png href=/media/icon_hub9a637e5d84e6d4c134f91fa57903eec_55838_32x32_fill_lanczos_center_3.png><link rel=apple-touch-icon type=image/png href=/media/icon_hub9a637e5d84e6d4c134f91fa57903eec_55838_180x180_fill_lanczos_center_3.png><meta name=theme-color content="#1565c0"><meta property="twitter:card" content="summary_large_image"><meta property="twitter:site" content="@Hua Zou"><meta property="twitter:creator" content="@Hua Zou"><meta property="twitter:image" content="https://zouhua.top/post/machine_learning/2023-04-27-ml010-rfoptimal/featured.png"><meta property="og:site_name" content="Hua's Cabin"><meta property="og:url" content="https://zouhua.top/post/machine_learning/2023-04-27-ml010-rfoptimal/"><meta property="og:title" content="How to choose the optimal features in Random Forest using R | Hua's Cabin"><meta property="og:description" content="Selecting the optimal biomarkers in Random Forest."><meta property="og:image" content="https://zouhua.top/post/machine_learning/2023-04-27-ml010-rfoptimal/featured.png"><meta property="og:locale" content="en-us"><meta property="article:published_time" content="2023-04-26T20:13:14+00:00"><meta property="article:modified_time" content="2023-04-25T22:13:14+00:00"><title>How to choose the optimal features in Random Forest using R | Hua's Cabin</title></head><body id=top data-spy=scroll data-offset=70 data-target=#TableOfContents class=page-wrapper data-wc-page-id=879e2321435498ba3cfa11a41dc3722c><script src=/js/wowchemy-init.min.ec9d49ca50e4b80bdb08f0417a28ed84.js></script><div class="page-header header--fixed"><header><nav class="navbar navbar-expand-lg navbar-light compensate-for-scrollbar" id=navbar-main><div class=container-xl><div class="d-none d-lg-inline-flex"><a class=navbar-brand href=/>Hua's Cabin</a></div><button type=button class=navbar-toggler data-toggle=collapse data-target=#navbar-content aria-controls=navbar-content aria-expanded=false aria-label="Toggle navigation">
<span><i class="fas fa-bars"></i></span></button><div class="navbar-brand-mobile-wrapper d-inline-flex d-lg-none"><a class=navbar-brand href=/>Hua's Cabin</a></div><div class="navbar-collapse main-menu-item collapse justify-content-start" id=navbar-content><ul class="navbar-nav d-md-inline-flex"><li class=nav-item><a class=nav-link href=/#about><span>Home</span></a></li><li class=nav-item><a class=nav-link href=/#posts><span>Posts</span></a></li><li class=nav-item><a class=nav-link href=/#experience><span>Experience</span></a></li><li class=nav-item><a class=nav-link href=/#publications><span>Publications</span></a></li><li class=nav-item><a class=nav-link href=/#contact><span>Contact</span></a></li><li class=nav-item><a class=nav-link href=/#bookdown><span>Bookdown</span></a></li></ul></div><ul class="nav-icons navbar-nav flex-row ml-auto d-flex pl-md-2"><li class=nav-item><a class="nav-link js-search" href=# aria-label=Search><i class="fas fa-search" aria-hidden=true></i></a></li><li class="nav-item dropdown theme-dropdown"><a href=# class=nav-link data-toggle=dropdown aria-haspopup=true aria-label="Display preferences"><i class="fas fa-moon" aria-hidden=true></i></a><div class=dropdown-menu><a href=# class="dropdown-item js-set-theme-light"><span>Light</span></a>
<a href=# class="dropdown-item js-set-theme-dark"><span>Dark</span></a>
<a href=# class="dropdown-item js-set-theme-auto"><span>Automatic</span></a></div></li></ul></div></nav></header></div><div class=page-body><div class="container-fluid docs"><div class="row flex-xl-nowrap"><div class="col-12 col-md-3 col-xl-2 docs-sidebar"><form class="docs-search d-flex align-items-center"><button class="btn docs-toggle d-md-none p-0 mr-md-3 w-100" type=button data-toggle=collapse data-target=#docs-nav aria-controls=docs-nav aria-expanded=false aria-label="Toggle section navigation"><div class=d-flex><span class="d-md-none pl-1 flex-grow-1 text-left overflow-hidden">Posts</span>
<span><i class="fas fa-chevron-down"></i></span></div></button></form><nav class="collapse docs-links" id=docs-nav><ul class="nav docs-sidenav"><li><a href=/post/><i class="fas fa-arrow-left pr-1"></i>Posts</a></li></ul><li class=active><a href=/post/machine_learning/2023-04-27-ml010-rfoptimal/>How to choose the optimal features in Random Forest using R</a></li></nav></div><div class="d-none d-xl-block col-xl-2 docs-toc"><ul class="nav toc-top"><li><a href=# id=back_to_top class=docs-toc-title>Contents</a></li></ul><nav id=TableOfContents><ul><li><a href=#importing-packages>Importing packages</a></li><li><a href=#importing-data>Importing data</a></li><li><a href=#data-partition>Data Partition</a></li><li><a href=#building-model>Building model</a></li><li><a href=#biomarkers-ordered-by-meandecreaseaccuracy>Biomarkers ordered by MeanDecreaseAccuracy</a></li><li><a href=#cross-validation>Cross validation</a></li><li><a href=#rebuilding-model-by-the-optimal-biomarkers>Rebuilding model by the optimal biomarkers</a></li><li><a href=#systemic-information>systemic information</a></li><li><a href=#summary>Summary</a></li><li><a href=#reference>Reference</a></li></ul></nav></div><main class="col-12 col-md-9 col-xl-8 py-md-3 pl-md-5 docs-content" role=main><div class=docs-article-container></div><div class=article-header><img src=/post/machine_learning/2023-04-27-ml010-rfoptimal/featured_hu508396607b5cd002212fa63e95595336_30611_1800x310_fit_q75_h2_lanczos_3.webp width=422 height=310 class=article-banner alt></div><div class=docs-article-container><h1>How to choose the optimal features in Random Forest using R</h1><article class=article-style><p>Random Forest, a ensemble machine learning algorithm with multiple decision trees could be used for classification or regression algorithm, and it has an elegant way of dealing with nonlinear or linear data.</p><blockquote><p>Random forest aims to reduce the previously mentioned correlation issue by choosing only a subsample of the feature space at each split. Essentially, it aims to make the trees de-correlated and prune the trees by setting a stopping criteria for node splits, which I will cover in more detail later.</p></blockquote><p>However, how to choose the optimal features to rebuild models is the key step for users. Herein, we gave the detailed tutorial step by step.</p><h2 id=importing-packages>Importing packages</h2><p>R packages used in this tutorial.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-r data-lang=r><span class=line><span class=cl><span class=n>knitr</span><span class=o>::</span><span class=n>opts_chunk</span><span class=o>$</span><span class=nf>set</span><span class=p>(</span><span class=n>message</span> <span class=o>=</span> <span class=kc>FALSE</span><span class=p>,</span> <span class=n>warning</span> <span class=o>=</span> <span class=kc>FALSE</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nf>library</span><span class=p>(</span><span class=n>dplyr</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nf>library</span><span class=p>(</span><span class=n>tibble</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nf>library</span><span class=p>(</span><span class=n>randomForest</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nf>library</span><span class=p>(</span><span class=n>ggplot2</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nf>library</span><span class=p>(</span><span class=n>data.table</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nf>library</span><span class=p>(</span><span class=n>caret</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nf>library</span><span class=p>(</span><span class=n>pROC</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># rm(list = ls())</span>
</span></span><span class=line><span class=cl><span class=nf>options</span><span class=p>(</span><span class=n>stringsAsFactors</span> <span class=o>=</span> <span class=bp>F</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nf>options</span><span class=p>(</span><span class=n>future.globals.maxSize</span> <span class=o>=</span> <span class=m>1000</span> <span class=o>*</span> <span class=m>1024</span><span class=n>^2</span><span class=p>)</span>
</span></span></code></pre></div><h2 id=importing-data>Importing data</h2><p><code>clean_data.csv</code> is from <a href=https://github.com/Jean-njoroge/Breast-cancer-risk-prediction/blob/master/data/clean-data.csv target=_blank rel=noopener>Breast-cancer-risk-prediction</a>. Using <em>wget <a href=https://github.com/Jean-njoroge/Breast-cancer-risk-prediction/blob/master/data/clean-data.csv target=_blank rel=noopener>https://github.com/Jean-njoroge/Breast-cancer-risk-prediction/blob/master/data/clean-data.csv</a></em> to download it.</p><p><code>clean_data.csv</code> contains 569 samples of malignant and benign tumor cells</p><blockquote><p>The Breast Cancer datasets is available machine learning repository maintained by the University of California, Irvine. The dataset contains 569 samples of malignant and benign tumor cells.</p></blockquote><blockquote><ol><li>The first two columns in the dataset store the unique ID numbers of the samples and the corresponding diagnosis (M=malignant, B=benign), respectively.</li></ol></blockquote><blockquote><ol start=2><li>The columns 3-32 contain 30 real-value features that have been computed from digitized images of the cell nuclei, which can be used to build a model to predict whether a tumor is benign or malignant.</li></ol></blockquote><div class=highlight><pre tabindex=0 class=chroma><code class=language-r data-lang=r><span class=line><span class=cl><span class=n>datset</span> <span class=o>&lt;-</span> <span class=n>data.table</span><span class=o>::</span><span class=nf>fread</span><span class=p>(</span><span class=s>&#34;clean_data.csv&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nf>head</span><span class=p>(</span><span class=n>datset[</span><span class=p>,</span> <span class=m>1</span><span class=o>:</span><span class=m>6</span><span class=n>]</span><span class=p>)</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-markdown data-lang=markdown><span class=line><span class=cl>   V1 diagnosis radius_mean texture_mean perimeter_mean
</span></span><span class=line><span class=cl>1:  0         M       17.99        10.38         122.80
</span></span><span class=line><span class=cl>2:  1         M       20.57        17.77         132.90
</span></span><span class=line><span class=cl>3:  2         M       19.69        21.25         130.00
</span></span><span class=line><span class=cl>4:  3         M       11.42        20.38          77.58
</span></span><span class=line><span class=cl>5:  4         M       20.29        14.34         135.10
</span></span><span class=line><span class=cl>6:  5         M       12.45        15.70          82.57
</span></span></code></pre></div><h2 id=data-partition>Data Partition</h2><p>Splitting dataset into TrainSet and TestSet, the former is used to build random forest model and the latter is used to evaluate the performance of model.</p><p>We used <code>caret::createDataPartition</code> with parameters <code>p = 0.7</code> to create trainData and testData dataset.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-r data-lang=r><span class=line><span class=cl><span class=n>mdat</span> <span class=o>&lt;-</span> <span class=n>datset</span> <span class=o>%&gt;%</span>
</span></span><span class=line><span class=cl>  <span class=n>dplyr</span><span class=o>::</span><span class=nf>select</span><span class=p>(</span><span class=o>-</span><span class=n>V1</span><span class=p>)</span> <span class=o>%&gt;%</span>
</span></span><span class=line><span class=cl>  <span class=n>dplyr</span><span class=o>::</span><span class=nf>rename</span><span class=p>(</span><span class=n>Group</span> <span class=o>=</span> <span class=n>diagnosis</span><span class=p>)</span> <span class=o>%&gt;%</span>
</span></span><span class=line><span class=cl>  <span class=n>dplyr</span><span class=o>::</span><span class=nf>mutate</span><span class=p>(</span><span class=n>Group</span> <span class=o>=</span> <span class=nf>factor</span><span class=p>(</span><span class=n>Group</span><span class=p>))</span> <span class=o>%&gt;%</span>
</span></span><span class=line><span class=cl>  <span class=nf>data.frame</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=nf>colnames</span><span class=p>(</span><span class=n>mdat</span><span class=p>)</span> <span class=o>&lt;-</span> <span class=nf>make.names</span><span class=p>(</span><span class=nf>colnames</span><span class=p>(</span><span class=n>mdat</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nf>set.seed</span><span class=p>(</span><span class=m>123</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>trainIndex</span> <span class=o>&lt;-</span> <span class=n>caret</span><span class=o>::</span><span class=nf>createDataPartition</span><span class=p>(</span>
</span></span><span class=line><span class=cl>          <span class=n>mdat</span><span class=o>$</span><span class=n>Group</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>          <span class=n>p</span> <span class=o>=</span> <span class=m>0.7</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>          <span class=n>list</span> <span class=o>=</span> <span class=kc>FALSE</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>          <span class=n>times</span> <span class=o>=</span> <span class=m>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>trainData</span> <span class=o>&lt;-</span> <span class=n>mdat[trainIndex</span><span class=p>,</span> <span class=n>]</span>
</span></span><span class=line><span class=cl><span class=n>X_train</span> <span class=o>&lt;-</span> <span class=n>trainData[</span><span class=p>,</span> <span class=m>-1</span><span class=n>]</span>
</span></span><span class=line><span class=cl><span class=n>y_train</span> <span class=o>&lt;-</span> <span class=n>trainData[</span><span class=p>,</span> <span class=m>1</span><span class=n>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>testData</span> <span class=o>&lt;-</span> <span class=n>mdat[</span><span class=o>-</span><span class=n>trainIndex</span><span class=p>,</span> <span class=n>]</span>
</span></span><span class=line><span class=cl><span class=n>X_test</span> <span class=o>&lt;-</span> <span class=n>testData[</span><span class=p>,</span> <span class=m>-1</span><span class=n>]</span>
</span></span><span class=line><span class=cl><span class=n>y_test</span> <span class=o>&lt;-</span> <span class=n>testData[</span><span class=p>,</span> <span class=m>1</span><span class=n>]</span>
</span></span></code></pre></div><h2 id=building-model>Building model</h2><p>fitting model with default using <code>randomForest</code> based on trainData set.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-r data-lang=r><span class=line><span class=cl><span class=nf>set.seed</span><span class=p>(</span><span class=m>123</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>rf_fit</span> <span class=o>&lt;-</span> <span class=nf>randomForest</span><span class=p>(</span><span class=n>Group</span> <span class=o>~</span> <span class=n>.,</span> <span class=n>data</span> <span class=o>=</span> <span class=n>trainData</span><span class=p>,</span> <span class=n>importance</span> <span class=o>=</span> <span class=kc>TRUE</span><span class=p>,</span> <span class=n>proximity</span> <span class=o>=</span> <span class=kc>TRUE</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>rf_fit</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-markdown data-lang=markdown><span class=line><span class=cl>Call:
</span></span><span class=line><span class=cl> randomForest(formula = Group ~ ., data = trainData, importance = TRUE,      proximity = TRUE) 
</span></span><span class=line><span class=cl>               Type of random forest: classification
</span></span><span class=line><span class=cl>                     Number of trees: 500
</span></span><span class=line><span class=cl>No. of variables tried at each split: 5
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        OOB estimate of  error rate: 4.26%
</span></span><span class=line><span class=cl>Confusion matrix:
</span></span><span class=line><span class=cl>    B   M class.error
</span></span><span class=line><span class=cl>B 241   9  0.03600000
</span></span><span class=line><span class=cl>M   8 141  0.05369128
</span></span></code></pre></div><p>The <em>OOB estimate of error rate</em> is <strong>4.26%</strong>, indicating the Accuracy of this RF model is <strong>95.74%</strong>.</p><h2 id=biomarkers-ordered-by-meandecreaseaccuracy>Biomarkers ordered by MeanDecreaseAccuracy</h2><p>Ordering the features&rsquo; importance by <code>MeanDecreaseAccuracy</code>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-r data-lang=r><span class=line><span class=cl><span class=n>imp_biomarker</span> <span class=o>&lt;-</span> <span class=n>tibble</span><span class=o>::</span><span class=nf>as_tibble</span><span class=p>(</span><span class=nf>round</span><span class=p>(</span><span class=nf>importance</span><span class=p>(</span><span class=n>rf_fit</span><span class=p>),</span> <span class=m>2</span><span class=p>),</span> <span class=n>rownames</span> <span class=o>=</span> <span class=s>&#34;Features&#34;</span><span class=p>)</span> <span class=o>%&gt;%</span> 
</span></span><span class=line><span class=cl>  <span class=n>dplyr</span><span class=o>::</span><span class=nf>arrange</span><span class=p>(</span><span class=nf>desc</span><span class=p>(</span><span class=n>MeanDecreaseAccuracy</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nf>head</span><span class=p>(</span><span class=n>imp_biomarker</span><span class=p>)</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-markdown data-lang=markdown><span class=line><span class=cl><span class=gh># A tibble: 6 × 5
</span></span></span><span class=line><span class=cl><span class=gh></span>  Features                 B     M MeanDecreaseAccuracy MeanDecreaseGini
</span></span><span class=line><span class=cl>  <span class=p>&lt;</span><span class=nt>chr</span><span class=p>&gt;</span>                <span class=p>&lt;</span><span class=nt>dbl</span><span class=p>&gt;</span> <span class=p>&lt;</span><span class=nt>dbl</span><span class=p>&gt;</span>                <span class=p>&lt;</span><span class=nt>dbl</span><span class=p>&gt;</span>            <span class=p>&lt;</span><span class=nt>dbl</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>1 concave.points_worst 14.6  12.5                  18.0            24.0 
</span></span><span class=line><span class=cl>2 perimeter_worst      13.7  11.6                  16.2            26.8 
</span></span><span class=line><span class=cl>3 radius_worst         13.1  11.4                  16.1            21.2 
</span></span><span class=line><span class=cl>4 area_worst           11.9  10.5                  14.5            20.5 
</span></span><span class=line><span class=cl>5 concavity_worst       8.94  9.74                 13.3             6.46
</span></span><span class=line><span class=cl>6 texture_worst         8.27 10.6                  12.9             3.27
</span></span></code></pre></div><p><code>MeanDecreaseAccuracy</code> shows that the contribution of the features. For exmple, removing <em>concave.points_worst</em> would decrease the accuracy by <strong>18.0%</strong>. The higher the <code>MeanDecreaseAccuracy</code> of the features, the more they contribute to the model.</p><h2 id=cross-validation>Cross validation</h2><p>5 replicates for the 5-folds cross-validation to obtain the mean error in order to avoid the over-fitting and under-fitting. Meanwhile, the optimal number of features is selected according to the number with the mean error.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-r data-lang=r><span class=line><span class=cl><span class=n>error.cv</span> <span class=o>&lt;-</span> <span class=nf>c</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=nf>for </span><span class=p>(</span><span class=n>i</span> <span class=n>in</span> <span class=m>1</span><span class=o>:</span><span class=m>5</span><span class=p>){</span>
</span></span><span class=line><span class=cl>  <span class=nf>print</span><span class=p>(</span><span class=n>i</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=nf>set.seed</span><span class=p>(</span><span class=n>i</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=n>fit</span> <span class=o>&lt;-</span> <span class=nf>rfcv</span><span class=p>(</span><span class=n>trainx</span> <span class=o>=</span> <span class=n>X_train</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>              <span class=n>trainy</span> <span class=o>=</span> <span class=n>y_train</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>              <span class=n>cv.fold</span> <span class=o>=</span> <span class=m>5</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>              <span class=n>scale</span> <span class=o>=</span> <span class=s>&#34;log&#34;</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>              <span class=n>step</span> <span class=o>=</span> <span class=m>0.9</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=n>error.cv</span> <span class=o>&lt;-</span> <span class=nf>cbind</span><span class=p>(</span><span class=n>error.cv</span><span class=p>,</span> <span class=n>fit</span><span class=o>$</span><span class=n>error.cv</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>n.var</span> <span class=o>&lt;-</span> <span class=nf>as.numeric</span><span class=p>(</span><span class=nf>rownames</span><span class=p>(</span><span class=n>error.cv</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=nf>colnames</span><span class=p>(</span><span class=n>error.cv</span><span class=p>)</span> <span class=o>&lt;-</span> <span class=nf>paste</span><span class=p>(</span><span class=s>&#39;error&#39;</span><span class=p>,</span> <span class=m>1</span><span class=o>:</span><span class=m>5</span><span class=p>,</span> <span class=n>sep</span> <span class=o>=</span> <span class=s>&#39;.&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>err.mean</span> <span class=o>&lt;-</span> <span class=nf>apply</span><span class=p>(</span><span class=n>error.cv</span><span class=p>,</span> <span class=m>1</span><span class=p>,</span> <span class=n>mean</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>err.df</span> <span class=o>&lt;-</span> <span class=nf>data.frame</span><span class=p>(</span><span class=n>num</span> <span class=o>=</span> <span class=n>n.var</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>                     <span class=n>err.mean</span> <span class=o>=</span> <span class=n>err.mean</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                     <span class=n>error.cv</span><span class=p>)</span> 
</span></span><span class=line><span class=cl><span class=nf>head</span><span class=p>(</span><span class=n>err.df[</span><span class=p>,</span> <span class=m>1</span><span class=o>:</span><span class=m>6</span><span class=n>]</span><span class=p>)</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-markdown data-lang=markdown><span class=line><span class=cl>   num   err.mean    error.1    error.2    error.3    error.4
</span></span><span class=line><span class=cl>30  30 0.04110276 0.03759398 0.04260652 0.04260652 0.04260652
</span></span><span class=line><span class=cl>27  27 0.04160401 0.04010025 0.04010025 0.04761905 0.04010025
</span></span><span class=line><span class=cl>24  24 0.04260652 0.04260652 0.04260652 0.04260652 0.04761905
</span></span><span class=line><span class=cl>22  22 0.04360902 0.04260652 0.04260652 0.04511278 0.04511278
</span></span><span class=line><span class=cl>20  20 0.04210526 0.04260652 0.04511278 0.04260652 0.04260652
</span></span><span class=line><span class=cl>18  18 0.04060150 0.04260652 0.04260652 0.04010025 0.04260652
</span></span></code></pre></div><ul><li>optimal number of biomarkers chosen by min cv.error</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-r data-lang=r><span class=line><span class=cl><span class=n>optimal</span> <span class=o>&lt;-</span> <span class=n>err.df</span><span class=o>$</span><span class=n>num</span><span class=nf>[which</span><span class=p>(</span><span class=n>err.df</span><span class=o>$</span><span class=n>err.mean</span> <span class=o>==</span> <span class=nf>min</span><span class=p>(</span><span class=n>err.df</span><span class=o>$</span><span class=n>err.mean</span><span class=p>))</span><span class=n>]</span>
</span></span><span class=line><span class=cl><span class=n>main_theme</span> <span class=o>&lt;-</span> 
</span></span><span class=line><span class=cl>  <span class=nf>theme</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=n>panel.background</span> <span class=o>=</span> <span class=nf>element_blank</span><span class=p>(),</span>
</span></span><span class=line><span class=cl>    <span class=n>panel.grid</span> <span class=o>=</span> <span class=nf>element_blank</span><span class=p>(),</span>
</span></span><span class=line><span class=cl>    <span class=n>axis.line.x</span> <span class=o>=</span> <span class=nf>element_line</span><span class=p>(</span><span class=n>linewidth</span> <span class=o>=</span> <span class=m>0.5</span><span class=p>,</span> <span class=n>color</span> <span class=o>=</span> <span class=s>&#34;black&#34;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>    <span class=n>axis.line.y</span> <span class=o>=</span> <span class=nf>element_line</span><span class=p>(</span><span class=n>linewidth</span> <span class=o>=</span> <span class=m>0.5</span><span class=p>,</span> <span class=n>color</span> <span class=o>=</span> <span class=s>&#34;black&#34;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>    <span class=n>axis.ticks</span> <span class=o>=</span> <span class=nf>element_line</span><span class=p>(</span><span class=n>color</span> <span class=o>=</span> <span class=s>&#34;black&#34;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>    <span class=n>axis.text</span> <span class=o>=</span> <span class=nf>element_text</span><span class=p>(</span><span class=n>color</span> <span class=o>=</span> <span class=s>&#34;black&#34;</span><span class=p>,</span> <span class=n>size</span> <span class=o>=</span> <span class=m>12</span><span class=p>),</span>
</span></span><span class=line><span class=cl>    <span class=n>legend.position</span> <span class=o>=</span> <span class=s>&#34;right&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>legend.background</span> <span class=o>=</span> <span class=nf>element_blank</span><span class=p>(),</span>
</span></span><span class=line><span class=cl>    <span class=n>legend.key</span> <span class=o>=</span> <span class=nf>element_blank</span><span class=p>(),</span>
</span></span><span class=line><span class=cl>    <span class=n>legend.text</span> <span class=o>=</span> <span class=nf>element_text</span><span class=p>(</span><span class=n>size</span> <span class=o>=</span> <span class=m>12</span><span class=p>),</span>
</span></span><span class=line><span class=cl>    <span class=n>text</span> <span class=o>=</span> <span class=nf>element_text</span><span class=p>(</span><span class=n>family</span> <span class=o>=</span> <span class=s>&#34;sans&#34;</span><span class=p>,</span> <span class=n>size</span> <span class=o>=</span> <span class=m>12</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>pl</span> <span class=o>&lt;-</span> 
</span></span><span class=line><span class=cl>  <span class=nf>ggplot</span><span class=p>(</span><span class=n>data</span> <span class=o>=</span> <span class=n>err.df</span><span class=p>,</span> <span class=nf>aes</span><span class=p>(</span><span class=n>x</span> <span class=o>=</span> <span class=n>err.df</span><span class=o>$</span><span class=n>num</span><span class=p>))</span> <span class=o>+</span> 
</span></span><span class=line><span class=cl>    <span class=nf>geom_line</span><span class=p>(</span><span class=nf>aes</span><span class=p>(</span><span class=n>y</span> <span class=o>=</span> <span class=n>err.df</span><span class=o>$</span><span class=n>error.1</span><span class=p>),</span> <span class=n>color</span> <span class=o>=</span> <span class=s>&#39;grey&#39;</span><span class=p>,</span> <span class=n>size</span> <span class=o>=</span> <span class=m>0.5</span><span class=p>)</span> <span class=o>+</span> 
</span></span><span class=line><span class=cl>    <span class=nf>geom_line</span><span class=p>(</span><span class=nf>aes</span><span class=p>(</span><span class=n>y</span> <span class=o>=</span> <span class=n>err.df</span><span class=o>$</span><span class=n>error.2</span><span class=p>),</span> <span class=n>color</span> <span class=o>=</span> <span class=s>&#39;grey&#39;</span><span class=p>,</span> <span class=n>size</span> <span class=o>=</span> <span class=m>0.5</span><span class=p>)</span> <span class=o>+</span>
</span></span><span class=line><span class=cl>    <span class=nf>geom_line</span><span class=p>(</span><span class=nf>aes</span><span class=p>(</span><span class=n>y</span> <span class=o>=</span> <span class=n>err.df</span><span class=o>$</span><span class=n>error.3</span><span class=p>),</span> <span class=n>color</span> <span class=o>=</span> <span class=s>&#39;grey&#39;</span><span class=p>,</span> <span class=n>size</span> <span class=o>=</span> <span class=m>0.5</span><span class=p>)</span> <span class=o>+</span>
</span></span><span class=line><span class=cl>    <span class=nf>geom_line</span><span class=p>(</span><span class=nf>aes</span><span class=p>(</span><span class=n>y</span> <span class=o>=</span> <span class=n>err.df</span><span class=o>$</span><span class=n>error.4</span><span class=p>),</span> <span class=n>color</span> <span class=o>=</span> <span class=s>&#39;grey&#39;</span><span class=p>,</span> <span class=n>size</span> <span class=o>=</span> <span class=m>0.5</span><span class=p>)</span> <span class=o>+</span>
</span></span><span class=line><span class=cl>    <span class=nf>geom_line</span><span class=p>(</span><span class=nf>aes</span><span class=p>(</span><span class=n>y</span> <span class=o>=</span> <span class=n>err.df</span><span class=o>$</span><span class=n>error.5</span><span class=p>),</span> <span class=n>color</span> <span class=o>=</span> <span class=s>&#39;grey&#39;</span><span class=p>,</span> <span class=n>size</span> <span class=o>=</span> <span class=m>0.5</span><span class=p>)</span> <span class=o>+</span>
</span></span><span class=line><span class=cl>    <span class=nf>geom_line</span><span class=p>(</span><span class=nf>aes</span><span class=p>(</span><span class=n>y</span> <span class=o>=</span> <span class=n>err.df</span><span class=o>$</span><span class=n>err.mean</span><span class=p>),</span> <span class=n>color</span> <span class=o>=</span> <span class=s>&#39;black&#39;</span><span class=p>,</span> <span class=n>size</span> <span class=o>=</span> <span class=m>0.5</span><span class=p>)</span> <span class=o>+</span> 
</span></span><span class=line><span class=cl>    <span class=nf>geom_vline</span><span class=p>(</span><span class=n>xintercept</span> <span class=o>=</span> <span class=n>optimal</span><span class=p>,</span> <span class=n>color</span> <span class=o>=</span> <span class=s>&#39;red&#39;</span><span class=p>,</span> <span class=n>lwd</span> <span class=o>=</span> <span class=m>0.36</span><span class=p>,</span> <span class=n>linetype</span> <span class=o>=</span> <span class=m>2</span><span class=p>)</span> <span class=o>+</span> 
</span></span><span class=line><span class=cl>    <span class=nf>coord_trans</span><span class=p>(</span><span class=n>x</span> <span class=o>=</span> <span class=s>&#34;log2&#34;</span><span class=p>)</span> <span class=o>+</span>
</span></span><span class=line><span class=cl>    <span class=nf>scale_x_continuous</span><span class=p>(</span><span class=n>breaks</span> <span class=o>=</span> <span class=nf>c</span><span class=p>(</span><span class=m>1</span><span class=p>,</span> <span class=m>5</span><span class=p>,</span> <span class=m>10</span><span class=p>,</span> <span class=m>20</span><span class=p>,</span> <span class=m>30</span><span class=p>))</span> <span class=o>+</span>
</span></span><span class=line><span class=cl>    <span class=nf>labs</span><span class=p>(</span><span class=n>x</span> <span class=o>=</span> <span class=s>&#39;Number of Species &#39;</span><span class=p>,</span> <span class=n>y</span> <span class=o>=</span> <span class=s>&#39;Cross-validation error rate&#39;</span><span class=p>)</span> <span class=o>+</span> 
</span></span><span class=line><span class=cl>    <span class=nf>annotate</span><span class=p>(</span><span class=s>&#34;text&#34;</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>             <span class=n>x</span> <span class=o>=</span> <span class=n>optimal</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>             <span class=n>y</span> <span class=o>=</span> <span class=nf>max</span><span class=p>(</span><span class=n>err.df</span><span class=o>$</span><span class=n>err.mean</span><span class=p>),</span> 
</span></span><span class=line><span class=cl>             <span class=n>label</span> <span class=o>=</span> <span class=nf>paste</span><span class=p>(</span><span class=s>&#34;Optimal = &#34;</span><span class=p>,</span> <span class=n>optimal</span><span class=p>,</span> <span class=n>sep</span> <span class=o>=</span> <span class=s>&#34;&#34;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>             <span class=n>color</span> <span class=o>=</span> <span class=s>&#34;red&#34;</span><span class=p>)</span> <span class=o>+</span>
</span></span><span class=line><span class=cl>    <span class=n>main_theme</span>
</span></span><span class=line><span class=cl><span class=n>pl</span>
</span></span></code></pre></div><p><figure><div class="d-flex justify-content-center"><div class=w-100><img src=https://raw.githubusercontent.com/HuaZou/Image_Host/main/img/image-20230427111833709.png alt loading=lazy data-zoomable></div></div></figure></p><p>Since the figure shows that the model had a minimum error rate when the number of features was <strong>18</strong>, the optimal number of biomarkers is <strong>18</strong>.</p><ul><li>importance of optimal biomarker</li></ul><p>Displaying the <code>MeanDecreaseAccuracy</code> of the best biomarkers</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-r data-lang=r><span class=line><span class=cl><span class=n>imp_biomarker[1</span><span class=o>:</span><span class=n>optimal</span><span class=p>,</span> <span class=n>]</span> <span class=o>%&gt;%</span>
</span></span><span class=line><span class=cl>  <span class=n>dplyr</span><span class=o>::</span><span class=nf>select</span><span class=p>(</span><span class=n>Features</span><span class=p>,</span> <span class=n>MeanDecreaseAccuracy</span><span class=p>)</span> <span class=o>%&gt;%</span>
</span></span><span class=line><span class=cl>  <span class=n>dplyr</span><span class=o>::</span><span class=nf>arrange</span><span class=p>(</span><span class=n>MeanDecreaseAccuracy</span><span class=p>)</span> <span class=o>%&gt;%</span>
</span></span><span class=line><span class=cl>  <span class=n>dplyr</span><span class=o>::</span><span class=nf>mutate</span><span class=p>(</span><span class=n>Features</span> <span class=o>=</span> <span class=n>forcats</span><span class=o>::</span><span class=nf>fct_inorder</span><span class=p>(</span><span class=n>Features</span><span class=p>))</span> <span class=o>%&gt;%</span>
</span></span><span class=line><span class=cl>  <span class=nf>ggplot</span><span class=p>(</span><span class=nf>aes</span><span class=p>(</span><span class=n>x</span> <span class=o>=</span> <span class=n>Features</span><span class=p>,</span> <span class=n>y</span> <span class=o>=</span> <span class=n>MeanDecreaseAccuracy</span><span class=p>))</span><span class=o>+</span>
</span></span><span class=line><span class=cl>    <span class=nf>geom_bar</span><span class=p>(</span><span class=n>stat</span> <span class=o>=</span> <span class=s>&#34;identity&#34;</span><span class=p>,</span> <span class=n>fill</span> <span class=o>=</span> <span class=s>&#34;white&#34;</span><span class=p>,</span> <span class=n>color</span> <span class=o>=</span> <span class=s>&#34;blue&#34;</span><span class=p>)</span> <span class=o>+</span>
</span></span><span class=line><span class=cl>    <span class=nf>labs</span><span class=p>(</span><span class=n>x</span> <span class=o>=</span> <span class=s>&#34;&#34;</span><span class=p>,</span> <span class=n>y</span> <span class=o>=</span> <span class=s>&#34;Mean decrease accuracy&#34;</span><span class=p>)</span> <span class=o>+</span>
</span></span><span class=line><span class=cl>    <span class=nf>coord_flip</span><span class=p>()</span> <span class=o>+</span>
</span></span><span class=line><span class=cl>    <span class=n>main_theme</span>
</span></span></code></pre></div><p><figure><div class="d-flex justify-content-center"><div class=w-100><img src=https://raw.githubusercontent.com/HuaZou/Image_Host/main/img/image-20230427105252101.png alt loading=lazy data-zoomable></div></div></figure></p><h2 id=rebuilding-model-by-the-optimal-biomarkers>Rebuilding model by the optimal biomarkers</h2><p>Here, we used the new candidates to rebuild the RF model, and the accuracy of the new model increased by 0.5% (the OOB error rate decreased from 4.26% to 3.76%).</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-r data-lang=r><span class=line><span class=cl><span class=n>selected_columns</span> <span class=o>&lt;-</span> <span class=nf>c</span><span class=p>(</span><span class=s>&#34;Group&#34;</span><span class=p>,</span> <span class=n>imp_biomarker[1</span><span class=o>:</span><span class=n>optimal</span><span class=p>,</span> <span class=n>]</span><span class=o>$</span><span class=n>Features</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>trainData_optimal</span> <span class=o>&lt;-</span> <span class=n>trainData</span> <span class=o>%&gt;%</span>
</span></span><span class=line><span class=cl>  <span class=n>dplyr</span><span class=o>::</span><span class=nf>select</span><span class=p>(</span><span class=nf>all_of</span><span class=p>(</span><span class=n>selected_columns</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>testData_optimal</span> <span class=o>&lt;-</span> <span class=n>testData</span> <span class=o>%&gt;%</span>
</span></span><span class=line><span class=cl>  <span class=n>dplyr</span><span class=o>::</span><span class=nf>select</span><span class=p>(</span><span class=nf>all_of</span><span class=p>(</span><span class=n>selected_columns</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nf>set.seed</span><span class=p>(</span><span class=m>123</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>rf_fit_optimal</span> <span class=o>&lt;-</span> <span class=nf>randomForest</span><span class=p>(</span><span class=n>Group</span> <span class=o>~</span> <span class=n>.,</span> <span class=n>data</span> <span class=o>=</span> <span class=n>trainData_optimal</span><span class=p>,</span> <span class=n>importance</span> <span class=o>=</span> <span class=kc>TRUE</span><span class=p>,</span> <span class=n>proximity</span> <span class=o>=</span> <span class=kc>TRUE</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>rf_fit_optimal</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-markdown data-lang=markdown><span class=line><span class=cl>Call:
</span></span><span class=line><span class=cl> randomForest(formula = Group ~ ., data = trainData_optimal, importance = TRUE,      proximity = TRUE) 
</span></span><span class=line><span class=cl>               Type of random forest: classification
</span></span><span class=line><span class=cl>                     Number of trees: 500
</span></span><span class=line><span class=cl>No. of variables tried at each split: 4
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        OOB estimate of  error rate: 3.76%
</span></span><span class=line><span class=cl>Confusion matrix:
</span></span><span class=line><span class=cl>    B   M class.error
</span></span><span class=line><span class=cl>B 242   8  0.03200000
</span></span><span class=line><span class=cl>M   7 142  0.04697987
</span></span></code></pre></div><ul><li>ConfusionMatrix</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-r data-lang=r><span class=line><span class=cl><span class=n>group_names</span> <span class=o>&lt;-</span> <span class=nf>c</span><span class=p>(</span><span class=s>&#34;B&#34;</span><span class=p>,</span> <span class=s>&#34;M&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>pred_raw</span> <span class=o>&lt;-</span> <span class=nf>predict</span><span class=p>(</span><span class=n>rf_fit_optimal</span><span class=p>,</span> <span class=n>newdata</span> <span class=o>=</span> <span class=n>testData_optimal</span><span class=p>,</span> <span class=n>type</span> <span class=o>=</span> <span class=s>&#34;response&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nf>print</span><span class=p>(</span><span class=n>caret</span><span class=o>::</span><span class=nf>confusionMatrix</span><span class=p>(</span><span class=n>pred_raw</span><span class=p>,</span> <span class=n>testData_optimal</span><span class=o>$</span><span class=n>Group</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=n>pred_prob</span> <span class=o>&lt;-</span> <span class=nf>predict</span><span class=p>(</span><span class=n>rf_fit_optimal</span><span class=p>,</span> <span class=n>newdata</span> <span class=o>=</span> <span class=n>testData_optimal</span><span class=p>,</span> <span class=n>type</span> <span class=o>=</span> <span class=s>&#34;prob&#34;</span><span class=p>)</span>  
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-markdown data-lang=markdown><span class=line><span class=cl>Confusion Matrix and Statistics
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>          Reference
</span></span><span class=line><span class=cl>Prediction   B   M
</span></span><span class=line><span class=cl>         B 105   3
</span></span><span class=line><span class=cl>         M   2  60
</span></span><span class=line><span class=cl>                                          
</span></span><span class=line><span class=cl>               Accuracy : 0.9706          
</span></span><span class=line><span class=cl>                 95% CI : (0.9327, 0.9904)
</span></span><span class=line><span class=cl>    No Information Rate : 0.6294          
</span></span><span class=line><span class=cl>    P-Value [Acc &gt; NIR] : <span class=p>&lt;</span><span class=nt>2e-16</span>          
</span></span><span class=line><span class=cl>                                          
</span></span><span class=line><span class=cl>                  <span class=na>Kappa</span> <span class=na>:</span> <span class=na>0</span><span class=err>.</span><span class=na>9367</span>          
</span></span><span class=line><span class=cl>                                          
</span></span><span class=line><span class=cl> <span class=na>Mcnemar</span><span class=err>&#39;</span><span class=na>s</span> <span class=na>Test</span> <span class=na>P-Value</span> <span class=na>:</span> <span class=na>1</span>               
</span></span><span class=line><span class=cl>                                          
</span></span><span class=line><span class=cl>            <span class=na>Sensitivity</span> <span class=na>:</span> <span class=na>0</span><span class=err>.</span><span class=na>9813</span>          
</span></span><span class=line><span class=cl>            <span class=na>Specificity</span> <span class=na>:</span> <span class=na>0</span><span class=err>.</span><span class=na>9524</span>          
</span></span><span class=line><span class=cl>         <span class=na>Pos</span> <span class=na>Pred</span> <span class=na>Value</span> <span class=na>:</span> <span class=na>0</span><span class=err>.</span><span class=na>9722</span>          
</span></span><span class=line><span class=cl>         <span class=na>Neg</span> <span class=na>Pred</span> <span class=na>Value</span> <span class=na>:</span> <span class=na>0</span><span class=err>.</span><span class=na>9677</span>          
</span></span><span class=line><span class=cl>             <span class=na>Prevalence</span> <span class=na>:</span> <span class=na>0</span><span class=err>.</span><span class=na>6294</span>          
</span></span><span class=line><span class=cl>         <span class=na>Detection</span> <span class=na>Rate</span> <span class=na>:</span> <span class=na>0</span><span class=err>.</span><span class=na>6176</span>          
</span></span><span class=line><span class=cl>   <span class=na>Detection</span> <span class=na>Prevalence</span> <span class=na>:</span> <span class=na>0</span><span class=err>.</span><span class=na>6353</span>          
</span></span><span class=line><span class=cl>      <span class=na>Balanced</span> <span class=na>Accuracy</span> <span class=na>:</span> <span class=na>0</span><span class=err>.</span><span class=na>9668</span>          
</span></span><span class=line><span class=cl>                                          
</span></span><span class=line><span class=cl>       <span class=err>&#39;</span><span class=na>Positive</span><span class=err>&#39;</span> <span class=na>Class</span> <span class=na>:</span> <span class=na>B</span> 
</span></span></code></pre></div><ul><li>performance of classifier</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-r data-lang=r><span class=line><span class=cl><span class=n>Evaluate_index</span> <span class=o>&lt;-</span> <span class=nf>function</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=n>DataTest</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>    <span class=n>PredProb</span> <span class=o>=</span> <span class=n>pred_prob</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>    <span class=n>label</span> <span class=o>=</span> <span class=n>group_names[1]</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>    <span class=n>PredRaw</span> <span class=o>=</span> <span class=n>pred_raw</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>  <span class=c1># DataTest = testData</span>
</span></span><span class=line><span class=cl>  <span class=c1># PredProb = pred_prob</span>
</span></span><span class=line><span class=cl>  <span class=c1># label = group_names[1]</span>
</span></span><span class=line><span class=cl>  <span class=c1># PredRaw = pred_raw</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>  <span class=c1># ROC object</span>
</span></span><span class=line><span class=cl>  <span class=n>rocobj</span> <span class=o>&lt;-</span> <span class=nf>roc</span><span class=p>(</span><span class=n>DataTest</span><span class=o>$</span><span class=n>Group</span><span class=p>,</span> <span class=n>PredProb[</span><span class=p>,</span> <span class=m>1</span><span class=n>]</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>  <span class=c1># confusionMatrix</span>
</span></span><span class=line><span class=cl>  <span class=n>con_matrix</span> <span class=o>&lt;-</span> <span class=nf>table</span><span class=p>(</span><span class=n>PredRaw</span><span class=p>,</span> <span class=n>DataTest</span><span class=o>$</span><span class=n>Group</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>  <span class=c1># index</span>
</span></span><span class=line><span class=cl>  <span class=n>TP</span> <span class=o>&lt;-</span> <span class=n>con_matrix[1</span><span class=p>,</span> <span class=m>1</span><span class=n>]</span>
</span></span><span class=line><span class=cl>  <span class=n>FN</span> <span class=o>&lt;-</span> <span class=n>con_matrix[2</span><span class=p>,</span> <span class=m>1</span><span class=n>]</span>
</span></span><span class=line><span class=cl>  <span class=n>FP</span> <span class=o>&lt;-</span> <span class=n>con_matrix[1</span><span class=p>,</span> <span class=m>2</span><span class=n>]</span>
</span></span><span class=line><span class=cl>  <span class=n>TN</span> <span class=o>&lt;-</span> <span class=n>con_matrix[2</span><span class=p>,</span> <span class=m>2</span><span class=n>]</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>  <span class=n>rocbj_df</span> <span class=o>&lt;-</span> <span class=nf>data.frame</span><span class=p>(</span><span class=n>threshold</span> <span class=o>=</span> <span class=nf>round</span><span class=p>(</span><span class=n>rocobj</span><span class=o>$</span><span class=n>thresholds</span><span class=p>,</span> <span class=m>3</span><span class=p>),</span>
</span></span><span class=line><span class=cl>                         <span class=n>sensitivities</span> <span class=o>=</span> <span class=nf>round</span><span class=p>(</span><span class=n>rocobj</span><span class=o>$</span><span class=n>sensitivities</span><span class=p>,</span> <span class=m>3</span><span class=p>),</span>
</span></span><span class=line><span class=cl>                         <span class=n>specificities</span> <span class=o>=</span> <span class=nf>round</span><span class=p>(</span><span class=n>rocobj</span><span class=o>$</span><span class=n>specificities</span><span class=p>,</span> <span class=m>3</span><span class=p>),</span>
</span></span><span class=line><span class=cl>                         <span class=n>value</span> <span class=o>=</span> <span class=n>rocobj</span><span class=o>$</span><span class=n>sensitivities</span> <span class=o>+</span> 
</span></span><span class=line><span class=cl>                           <span class=n>rocobj</span><span class=o>$</span><span class=n>specificities</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=n>max_value_row</span> <span class=o>&lt;-</span> <span class=nf>which</span><span class=p>(</span><span class=nf>max</span><span class=p>(</span><span class=n>rocbj_df</span><span class=o>$</span><span class=n>value</span><span class=p>)</span> <span class=o>==</span> <span class=n>rocbj_df</span><span class=o>$</span><span class=n>value</span><span class=p>)</span><span class=n>[1]</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>  <span class=n>threshold</span> <span class=o>&lt;-</span> <span class=n>rocbj_df</span><span class=o>$</span><span class=n>threshold[max_value_row]</span>
</span></span><span class=line><span class=cl>  <span class=n>sen</span> <span class=o>&lt;-</span> <span class=nf>round</span><span class=p>(</span><span class=n>TP</span> <span class=o>/</span> <span class=p>(</span><span class=n>TP</span> <span class=o>+</span> <span class=n>FN</span><span class=p>),</span> <span class=m>3</span><span class=p>)</span> <span class=c1># caret::sensitivity(con_matrix)</span>
</span></span><span class=line><span class=cl>  <span class=n>spe</span> <span class=o>&lt;-</span> <span class=nf>round</span><span class=p>(</span><span class=n>TN</span> <span class=o>/</span> <span class=p>(</span><span class=n>TN</span> <span class=o>+</span> <span class=n>FP</span><span class=p>),</span> <span class=m>3</span><span class=p>)</span> <span class=c1># caret::specificity(con_matrix)</span>
</span></span><span class=line><span class=cl>  <span class=n>acc</span> <span class=o>&lt;-</span> <span class=nf>round</span><span class=p>((</span><span class=n>TP</span> <span class=o>+</span> <span class=n>TN</span><span class=p>)</span> <span class=o>/</span> <span class=p>(</span><span class=n>TP</span> <span class=o>+</span> <span class=n>TN</span> <span class=o>+</span> <span class=n>FP</span> <span class=o>+</span> <span class=n>FN</span><span class=p>),</span> <span class=m>3</span><span class=p>)</span> <span class=c1># Accuracy</span>
</span></span><span class=line><span class=cl>  <span class=n>pre</span> <span class=o>&lt;-</span> <span class=nf>round</span><span class=p>(</span><span class=n>TP</span> <span class=o>/</span> <span class=p>(</span><span class=n>TP</span> <span class=o>+</span> <span class=n>FP</span><span class=p>),</span> <span class=m>3</span><span class=p>)</span> <span class=c1># precision</span>
</span></span><span class=line><span class=cl>  <span class=n>rec</span> <span class=o>&lt;-</span> <span class=nf>round</span><span class=p>(</span><span class=n>TP</span> <span class=o>/</span> <span class=p>(</span><span class=n>TP</span> <span class=o>+</span> <span class=n>FN</span><span class=p>),</span> <span class=m>3</span><span class=p>)</span> <span class=c1># recall</span>
</span></span><span class=line><span class=cl>  <span class=c1>#F1S &lt;- round(2 * TP / (TP + TN + FP + FN + TP - TN), 3)# F1-Score</span>
</span></span><span class=line><span class=cl>  <span class=n>F1S</span> <span class=o>&lt;-</span> <span class=nf>round</span><span class=p>(</span><span class=m>2</span> <span class=o>*</span> <span class=n>TP</span> <span class=o>/</span> <span class=p>(</span><span class=m>2</span> <span class=o>*</span> <span class=n>TP</span> <span class=o>+</span> <span class=n>FP</span> <span class=o>+</span> <span class=n>FN</span><span class=p>),</span> <span class=m>3</span><span class=p>)</span><span class=c1># F1-Score</span>
</span></span><span class=line><span class=cl>  <span class=n>youden</span> <span class=o>&lt;-</span> <span class=n>sen</span> <span class=o>+</span> <span class=n>spe</span> <span class=o>-</span> <span class=m>1</span> <span class=c1># youden index</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>  <span class=n>index_df</span> <span class=o>&lt;-</span> <span class=nf>data.frame</span><span class=p>(</span><span class=n>Index</span> <span class=o>=</span> <span class=nf>c</span><span class=p>(</span><span class=s>&#34;Threshold&#34;</span><span class=p>,</span> <span class=s>&#34;Sensitivity&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                                   <span class=s>&#34;Specificity&#34;</span><span class=p>,</span> <span class=s>&#34;Accuracy&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                                   <span class=s>&#34;Precision&#34;</span><span class=p>,</span> <span class=s>&#34;Recall&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                                   <span class=s>&#34;F1 Score&#34;</span><span class=p>,</span> <span class=s>&#34;Youden index&#34;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>                         <span class=n>Value</span> <span class=o>=</span> <span class=nf>c</span><span class=p>(</span><span class=n>threshold</span><span class=p>,</span> <span class=n>sen</span><span class=p>,</span> <span class=n>spe</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                                   <span class=n>acc</span><span class=p>,</span> <span class=n>pre</span><span class=p>,</span> <span class=n>rec</span><span class=p>,</span> <span class=n>F1S</span><span class=p>,</span> <span class=n>youden</span><span class=p>))</span> <span class=o>%&gt;%</span>
</span></span><span class=line><span class=cl>    <span class=n>stats</span><span class=o>::</span><span class=nf>setNames</span><span class=p>(</span><span class=nf>c</span><span class=p>(</span><span class=s>&#34;Index&#34;</span><span class=p>,</span> <span class=n>label</span><span class=p>))</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>  <span class=nf>return</span><span class=p>(</span><span class=n>index_df</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nf>Evaluate_index</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=n>DataTest</span> <span class=o>=</span> <span class=n>testData</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>    <span class=n>PredProb</span> <span class=o>=</span> <span class=n>pred_prob</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>    <span class=n>label</span> <span class=o>=</span> <span class=n>group_names[1]</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>    <span class=n>PredRaw</span> <span class=o>=</span> <span class=n>pred_raw</span><span class=p>)</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-markdown data-lang=markdown><span class=line><span class=cl>         Index     B
</span></span><span class=line><span class=cl>1    Threshold 0.556
</span></span><span class=line><span class=cl>2  Sensitivity 0.981
</span></span><span class=line><span class=cl>3  Specificity 0.952
</span></span><span class=line><span class=cl>4     Accuracy 0.971
</span></span><span class=line><span class=cl>5    Precision 0.972
</span></span><span class=line><span class=cl>6       Recall 0.981
</span></span><span class=line><span class=cl>7     F1 Score 0.977
</span></span><span class=line><span class=cl>8 Youden index 0.933
</span></span></code></pre></div><ul><li>AUROC</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-r data-lang=r><span class=line><span class=cl><span class=n>AUROC</span> <span class=o>&lt;-</span> <span class=nf>function</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=n>DataTest</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>    <span class=n>PredProb</span> <span class=o>=</span> <span class=n>pred_prob</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>    <span class=n>label</span> <span class=o>=</span> <span class=n>group_names[1]</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>    <span class=n>DataProf</span> <span class=o>=</span> <span class=n>profile</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>  <span class=c1># ROC object</span>
</span></span><span class=line><span class=cl>  <span class=n>rocobj</span> <span class=o>&lt;-</span> <span class=nf>roc</span><span class=p>(</span><span class=n>DataTest</span><span class=o>$</span><span class=n>Group</span><span class=p>,</span> <span class=n>PredProb[</span><span class=p>,</span> <span class=m>1</span><span class=n>]</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>  <span class=c1># Youden index: cutoff point</span>
</span></span><span class=line><span class=cl>  <span class=c1># plot(rocobj,</span>
</span></span><span class=line><span class=cl>  <span class=c1>#      legacy.axes = TRUE,</span>
</span></span><span class=line><span class=cl>  <span class=c1>#      of = &#34;thresholds&#34;, </span>
</span></span><span class=line><span class=cl>  <span class=c1>#      thresholds = &#34;best&#34;, </span>
</span></span><span class=line><span class=cl>  <span class=c1>#      print.thres=&#34;best&#34;)</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>  <span class=c1># AUROC data</span>
</span></span><span class=line><span class=cl>  <span class=n>roc</span> <span class=o>&lt;-</span> <span class=nf>data.frame</span><span class=p>(</span><span class=n>tpr</span> <span class=o>=</span> <span class=n>rocobj</span><span class=o>$</span><span class=n>sensitivities</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=n>fpr</span> <span class=o>=</span> <span class=m>1</span> <span class=o>-</span> <span class=n>rocobj</span><span class=o>$</span><span class=n>specificities</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>  <span class=c1># AUC 95% CI</span>
</span></span><span class=line><span class=cl>  <span class=n>rocobj_CI</span> <span class=o>&lt;-</span> <span class=nf>roc</span><span class=p>(</span><span class=n>DataTest</span><span class=o>$</span><span class=n>Group</span><span class=p>,</span> <span class=n>PredProb[</span><span class=p>,</span> <span class=m>1</span><span class=n>]</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>                   <span class=n>ci</span> <span class=o>=</span> <span class=kc>TRUE</span><span class=p>,</span> <span class=n>percent</span> <span class=o>=</span> <span class=kc>TRUE</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=n>roc_CI</span> <span class=o>&lt;-</span> <span class=nf>round</span><span class=p>(</span><span class=nf>as.numeric</span><span class=p>(</span><span class=n>rocobj_CI</span><span class=o>$</span><span class=n>ci</span><span class=p>)</span><span class=o>/</span><span class=m>100</span><span class=p>,</span> <span class=m>3</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=n>roc_CI_lab</span> <span class=o>&lt;-</span> <span class=nf>paste0</span><span class=p>(</span><span class=n>label</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>                       <span class=s>&#34; (&#34;</span><span class=p>,</span> <span class=s>&#34;AUC=&#34;</span><span class=p>,</span> <span class=n>roc_CI[2]</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>                       <span class=s>&#34;, 95%CI &#34;</span><span class=p>,</span> <span class=n>roc_CI[1]</span><span class=p>,</span> <span class=s>&#34;-&#34;</span><span class=p>,</span> <span class=n>roc_CI[3]</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>                       <span class=s>&#34;)&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=c1># ROC dataframe</span>
</span></span><span class=line><span class=cl>  <span class=n>rocbj_df</span> <span class=o>&lt;-</span> <span class=nf>data.frame</span><span class=p>(</span><span class=n>threshold</span> <span class=o>=</span> <span class=nf>round</span><span class=p>(</span><span class=n>rocobj</span><span class=o>$</span><span class=n>thresholds</span><span class=p>,</span> <span class=m>3</span><span class=p>),</span>
</span></span><span class=line><span class=cl>                         <span class=n>sensitivities</span> <span class=o>=</span> <span class=nf>round</span><span class=p>(</span><span class=n>rocobj</span><span class=o>$</span><span class=n>sensitivities</span><span class=p>,</span> <span class=m>3</span><span class=p>),</span>
</span></span><span class=line><span class=cl>                         <span class=n>specificities</span> <span class=o>=</span> <span class=nf>round</span><span class=p>(</span><span class=n>rocobj</span><span class=o>$</span><span class=n>specificities</span><span class=p>,</span> <span class=m>3</span><span class=p>),</span>
</span></span><span class=line><span class=cl>                         <span class=n>value</span> <span class=o>=</span> <span class=n>rocobj</span><span class=o>$</span><span class=n>sensitivities</span> <span class=o>+</span> 
</span></span><span class=line><span class=cl>                           <span class=n>rocobj</span><span class=o>$</span><span class=n>specificities</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=n>max_value_row</span> <span class=o>&lt;-</span> <span class=nf>which</span><span class=p>(</span><span class=nf>max</span><span class=p>(</span><span class=n>rocbj_df</span><span class=o>$</span><span class=n>value</span><span class=p>)</span> <span class=o>==</span> <span class=n>rocbj_df</span><span class=o>$</span><span class=n>value</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=n>threshold</span> <span class=o>&lt;-</span> <span class=n>rocbj_df</span><span class=o>$</span><span class=n>threshold[max_value_row]</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>  <span class=c1># plot</span>
</span></span><span class=line><span class=cl>  <span class=n>pl</span> <span class=o>&lt;-</span> <span class=nf>ggplot</span><span class=p>(</span><span class=n>data</span> <span class=o>=</span> <span class=n>roc</span><span class=p>,</span> <span class=nf>aes</span><span class=p>(</span><span class=n>x</span> <span class=o>=</span> <span class=n>fpr</span><span class=p>,</span> <span class=n>y</span> <span class=o>=</span> <span class=n>tpr</span><span class=p>))</span> <span class=o>+</span>
</span></span><span class=line><span class=cl>    <span class=nf>geom_path</span><span class=p>(</span><span class=n>color</span> <span class=o>=</span> <span class=s>&#34;red&#34;</span><span class=p>,</span> <span class=n>size</span> <span class=o>=</span> <span class=m>1</span><span class=p>)</span> <span class=o>+</span>
</span></span><span class=line><span class=cl>    <span class=nf>geom_abline</span><span class=p>(</span><span class=n>intercept</span> <span class=o>=</span> <span class=m>0</span><span class=p>,</span> <span class=n>slope</span> <span class=o>=</span> <span class=m>1</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>                <span class=n>color</span> <span class=o>=</span> <span class=s>&#34;grey&#34;</span><span class=p>,</span> <span class=n>size</span> <span class=o>=</span> <span class=m>1</span><span class=p>,</span> <span class=n>linetype</span> <span class=o>=</span> <span class=m>2</span><span class=p>)</span> <span class=o>+</span>
</span></span><span class=line><span class=cl>    <span class=nf>labs</span><span class=p>(</span><span class=n>x</span> <span class=o>=</span> <span class=s>&#34;False Positive Rate (1 - Specificity)&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>         <span class=n>y</span> <span class=o>=</span> <span class=s>&#34;True Positive Rate&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>         <span class=n>title</span> <span class=o>=</span> <span class=nf>paste0</span><span class=p>(</span><span class=s>&#34;AUROC (&#34;</span><span class=p>,</span> <span class=n>DataProf</span><span class=p>,</span> <span class=s>&#34; Features)&#34;</span><span class=p>))</span> <span class=o>+</span>
</span></span><span class=line><span class=cl>    <span class=nf>annotate</span><span class=p>(</span><span class=s>&#34;text&#34;</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>             <span class=n>x</span> <span class=o>=</span> <span class=m>1</span> <span class=o>-</span> <span class=n>rocbj_df</span><span class=o>$</span><span class=n>specificities[max_value_row]</span> <span class=o>+</span> <span class=m>0.15</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>             <span class=n>y</span> <span class=o>=</span> <span class=n>rocbj_df</span><span class=o>$</span><span class=n>sensitivities[max_value_row]</span> <span class=o>-</span> <span class=m>0.05</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>             <span class=n>label</span> <span class=o>=</span> <span class=nf>paste0</span><span class=p>(</span><span class=n>threshold</span><span class=p>,</span> <span class=s>&#34; (&#34;</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>                            <span class=n>rocbj_df</span><span class=o>$</span><span class=n>specificities[max_value_row]</span><span class=p>,</span> <span class=s>&#34;,&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                            <span class=n>rocbj_df</span><span class=o>$</span><span class=n>sensitivities[max_value_row]</span><span class=p>,</span> <span class=s>&#34;)&#34;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>             <span class=n>size</span><span class=o>=</span><span class=m>5</span><span class=p>,</span> <span class=n>family</span><span class=o>=</span><span class=s>&#34;serif&#34;</span><span class=p>)</span> <span class=o>+</span>
</span></span><span class=line><span class=cl>    <span class=nf>annotate</span><span class=p>(</span><span class=s>&#34;point&#34;</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>             <span class=n>x</span> <span class=o>=</span> <span class=m>1</span> <span class=o>-</span> <span class=n>rocbj_df</span><span class=o>$</span><span class=n>specificities[max_value_row]</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>             <span class=n>y</span> <span class=o>=</span> <span class=n>rocbj_df</span><span class=o>$</span><span class=n>sensitivities[max_value_row]</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>             <span class=n>color</span> <span class=o>=</span> <span class=s>&#34;black&#34;</span><span class=p>,</span> <span class=n>size</span> <span class=o>=</span> <span class=m>2</span><span class=p>)</span> <span class=o>+</span>    
</span></span><span class=line><span class=cl>    <span class=nf>annotate</span><span class=p>(</span><span class=s>&#34;text&#34;</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>             <span class=n>x</span> <span class=o>=</span> <span class=m>.75</span><span class=p>,</span> <span class=n>y</span> <span class=o>=</span> <span class=m>.25</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>             <span class=n>label</span> <span class=o>=</span> <span class=n>roc_CI_lab</span><span class=p>,</span>
</span></span><span class=line><span class=cl>             <span class=n>size</span> <span class=o>=</span> <span class=m>5</span><span class=p>,</span> <span class=n>family</span> <span class=o>=</span> <span class=s>&#34;serif&#34;</span><span class=p>)</span> <span class=o>+</span>
</span></span><span class=line><span class=cl>    <span class=nf>coord_cartesian</span><span class=p>(</span><span class=n>xlim</span> <span class=o>=</span> <span class=nf>c</span><span class=p>(</span><span class=m>0</span><span class=p>,</span> <span class=m>1</span><span class=p>),</span> <span class=n>ylim</span> <span class=o>=</span> <span class=nf>c</span><span class=p>(</span><span class=m>0</span><span class=p>,</span> <span class=m>1</span><span class=p>))</span> <span class=o>+</span>
</span></span><span class=line><span class=cl>    <span class=nf>theme_bw</span><span class=p>()</span> <span class=o>+</span>
</span></span><span class=line><span class=cl>    <span class=nf>theme</span><span class=p>(</span><span class=n>panel.background</span> <span class=o>=</span> <span class=nf>element_rect</span><span class=p>(</span><span class=n>fill</span> <span class=o>=</span> <span class=s>&#34;transparent&#34;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>          <span class=n>plot.title</span> <span class=o>=</span> <span class=nf>element_text</span><span class=p>(</span><span class=n>color</span> <span class=o>=</span> <span class=s>&#34;black&#34;</span><span class=p>,</span> <span class=n>size</span> <span class=o>=</span> <span class=m>14</span><span class=p>,</span> <span class=n>face</span> <span class=o>=</span> <span class=s>&#34;bold&#34;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>          <span class=n>axis.ticks.length</span> <span class=o>=</span> <span class=nf>unit</span><span class=p>(</span><span class=m>0.4</span><span class=p>,</span> <span class=s>&#34;lines&#34;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>          <span class=n>axis.ticks</span> <span class=o>=</span> <span class=nf>element_line</span><span class=p>(</span><span class=n>color</span> <span class=o>=</span> <span class=s>&#34;black&#34;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>          <span class=n>axis.line</span> <span class=o>=</span> <span class=nf>element_line</span><span class=p>(</span><span class=n>size</span> <span class=o>=</span> <span class=m>.5</span><span class=p>,</span> <span class=n>color</span> <span class=o>=</span> <span class=s>&#34;black&#34;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>          <span class=n>axis.title</span> <span class=o>=</span> <span class=nf>element_text</span><span class=p>(</span><span class=n>color</span> <span class=o>=</span> <span class=s>&#34;black&#34;</span><span class=p>,</span> <span class=n>size</span> <span class=o>=</span> <span class=m>12</span><span class=p>,</span> <span class=n>face</span> <span class=o>=</span> <span class=s>&#34;bold&#34;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>          <span class=n>axis.text</span> <span class=o>=</span> <span class=nf>element_text</span><span class=p>(</span><span class=n>color</span> <span class=o>=</span> <span class=s>&#34;black&#34;</span><span class=p>,</span> <span class=n>size</span> <span class=o>=</span> <span class=m>10</span><span class=p>),</span>
</span></span><span class=line><span class=cl>          <span class=n>text</span> <span class=o>=</span> <span class=nf>element_text</span><span class=p>(</span><span class=n>size</span> <span class=o>=</span> <span class=m>8</span><span class=p>,</span> <span class=n>color</span> <span class=o>=</span> <span class=s>&#34;black&#34;</span><span class=p>,</span> <span class=n>family</span> <span class=o>=</span> <span class=s>&#34;serif&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>  <span class=n>res</span> <span class=o>&lt;-</span> <span class=nf>list</span><span class=p>(</span><span class=n>rocobj</span> <span class=o>=</span> <span class=n>rocobj</span><span class=p>,</span>
</span></span><span class=line><span class=cl>              <span class=n>roc_CI</span> <span class=o>=</span> <span class=n>roc_CI_lab</span><span class=p>,</span>
</span></span><span class=line><span class=cl>              <span class=n>roc_pl</span> <span class=o>=</span> <span class=n>pl</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>  <span class=nf>return</span><span class=p>(</span><span class=n>res</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>AUROC_res</span> <span class=o>&lt;-</span> <span class=nf>AUROC</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=n>DataTest</span> <span class=o>=</span> <span class=n>testData</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>    <span class=n>PredProb</span> <span class=o>=</span> <span class=n>pred_prob</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>    <span class=n>label</span> <span class=o>=</span> <span class=n>group_names[1]</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>    <span class=n>DataProf</span> <span class=o>=</span> <span class=n>optimal</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>AUROC_res</span><span class=o>$</span><span class=n>roc_pl</span>
</span></span></code></pre></div><p><figure><div class="d-flex justify-content-center"><div class=w-100><img src=https://raw.githubusercontent.com/HuaZou/Image_Host/main/img/image-20230427105553133.png alt loading=lazy data-zoomable></div></div></figure></p><ul><li>AUPRC</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-r data-lang=r><span class=line><span class=cl><span class=n>AUPRC</span> <span class=o>&lt;-</span> <span class=nf>function</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=n>DataTest</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>    <span class=n>PredProb</span> <span class=o>=</span> <span class=n>pred_prob</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>    <span class=n>DataProf</span> <span class=o>=</span> <span class=n>optimal</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>  <span class=c1># ROC object</span>
</span></span><span class=line><span class=cl>  <span class=n>rocobj</span> <span class=o>&lt;-</span> <span class=nf>roc</span><span class=p>(</span><span class=n>DataTest</span><span class=o>$</span><span class=n>Group</span><span class=p>,</span> <span class=n>PredProb[</span><span class=p>,</span> <span class=m>1</span><span class=n>]</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>  <span class=c1># p-r value </span>
</span></span><span class=line><span class=cl>  <span class=n>dat_PR</span> <span class=o>&lt;-</span> <span class=nf>coords</span><span class=p>(</span><span class=n>rocobj</span><span class=p>,</span> <span class=s>&#34;all&#34;</span><span class=p>,</span> <span class=n>ret</span> <span class=o>=</span> <span class=nf>c</span><span class=p>(</span><span class=s>&#34;precision&#34;</span><span class=p>,</span> <span class=s>&#34;recall&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>  <span class=c1># AUPRC data</span>
</span></span><span class=line><span class=cl>  <span class=n>prc</span> <span class=o>&lt;-</span> <span class=nf>data.frame</span><span class=p>(</span><span class=n>precision</span> <span class=o>=</span> <span class=n>dat_PR</span><span class=o>$</span><span class=n>precision</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=n>recall</span> <span class=o>=</span> <span class=n>dat_PR</span><span class=o>$</span><span class=n>recall</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>  <span class=c1># plot</span>
</span></span><span class=line><span class=cl>  <span class=n>pl</span> <span class=o>&lt;-</span> <span class=nf>ggplot</span><span class=p>(</span><span class=n>data</span> <span class=o>=</span> <span class=n>prc</span><span class=p>,</span> <span class=nf>aes</span><span class=p>(</span><span class=n>x</span> <span class=o>=</span> <span class=n>recall</span><span class=p>,</span> <span class=n>y</span> <span class=o>=</span> <span class=n>precision</span><span class=p>))</span> <span class=o>+</span>
</span></span><span class=line><span class=cl>    <span class=nf>geom_path</span><span class=p>(</span><span class=n>color</span> <span class=o>=</span> <span class=s>&#34;red&#34;</span><span class=p>,</span> <span class=n>size</span> <span class=o>=</span> <span class=m>1</span><span class=p>)</span> <span class=o>+</span>
</span></span><span class=line><span class=cl>    <span class=nf>labs</span><span class=p>(</span><span class=n>x</span> <span class=o>=</span> <span class=s>&#34;Recall&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>         <span class=n>y</span> <span class=o>=</span> <span class=s>&#34;Precision&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>         <span class=n>title</span> <span class=o>=</span> <span class=nf>paste0</span><span class=p>(</span><span class=s>&#34;AUPRC (&#34;</span><span class=p>,</span> <span class=n>DataProf</span><span class=p>,</span> <span class=s>&#34; Features)&#34;</span><span class=p>))</span> <span class=o>+</span>
</span></span><span class=line><span class=cl>    <span class=nf>coord_cartesian</span><span class=p>(</span><span class=n>xlim</span> <span class=o>=</span> <span class=nf>c</span><span class=p>(</span><span class=m>0</span><span class=p>,</span> <span class=m>1</span><span class=p>),</span> <span class=n>ylim</span> <span class=o>=</span> <span class=nf>c</span><span class=p>(</span><span class=m>0</span><span class=p>,</span> <span class=m>1</span><span class=p>))</span> <span class=o>+</span>
</span></span><span class=line><span class=cl>    <span class=nf>theme_bw</span><span class=p>()</span> <span class=o>+</span>
</span></span><span class=line><span class=cl>    <span class=nf>theme</span><span class=p>(</span><span class=n>panel.background</span> <span class=o>=</span> <span class=nf>element_rect</span><span class=p>(</span><span class=n>fill</span> <span class=o>=</span> <span class=s>&#34;transparent&#34;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>          <span class=n>plot.title</span> <span class=o>=</span> <span class=nf>element_text</span><span class=p>(</span><span class=n>color</span> <span class=o>=</span> <span class=s>&#34;black&#34;</span><span class=p>,</span> <span class=n>size</span> <span class=o>=</span> <span class=m>14</span><span class=p>,</span> <span class=n>face</span> <span class=o>=</span> <span class=s>&#34;bold&#34;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>          <span class=n>axis.ticks.length</span> <span class=o>=</span> <span class=nf>unit</span><span class=p>(</span><span class=m>0.4</span><span class=p>,</span> <span class=s>&#34;lines&#34;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>          <span class=n>axis.ticks</span> <span class=o>=</span> <span class=nf>element_line</span><span class=p>(</span><span class=n>color</span> <span class=o>=</span> <span class=s>&#34;black&#34;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>          <span class=n>axis.line</span> <span class=o>=</span> <span class=nf>element_line</span><span class=p>(</span><span class=n>size</span> <span class=o>=</span> <span class=m>.5</span><span class=p>,</span> <span class=n>color</span> <span class=o>=</span> <span class=s>&#34;black&#34;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>          <span class=n>axis.title</span> <span class=o>=</span> <span class=nf>element_text</span><span class=p>(</span><span class=n>color</span> <span class=o>=</span> <span class=s>&#34;black&#34;</span><span class=p>,</span> <span class=n>size</span> <span class=o>=</span> <span class=m>12</span><span class=p>,</span> <span class=n>face</span> <span class=o>=</span> <span class=s>&#34;bold&#34;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>          <span class=n>axis.text</span> <span class=o>=</span> <span class=nf>element_text</span><span class=p>(</span><span class=n>color</span> <span class=o>=</span> <span class=s>&#34;black&#34;</span><span class=p>,</span> <span class=n>size</span> <span class=o>=</span> <span class=m>10</span><span class=p>),</span>
</span></span><span class=line><span class=cl>          <span class=n>text</span> <span class=o>=</span> <span class=nf>element_text</span><span class=p>(</span><span class=n>size</span> <span class=o>=</span> <span class=m>8</span><span class=p>,</span> <span class=n>color</span> <span class=o>=</span> <span class=s>&#34;black&#34;</span><span class=p>,</span> <span class=n>family</span> <span class=o>=</span> <span class=s>&#34;serif&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>  <span class=n>res</span> <span class=o>&lt;-</span> <span class=nf>list</span><span class=p>(</span><span class=n>dat_PR</span> <span class=o>=</span> <span class=n>dat_PR</span><span class=p>,</span>
</span></span><span class=line><span class=cl>              <span class=n>PC_pl</span> <span class=o>=</span> <span class=n>pl</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>  <span class=nf>return</span><span class=p>(</span><span class=n>res</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>AUPRC_res</span> <span class=o>&lt;-</span> <span class=nf>AUPRC</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=n>DataTest</span> <span class=o>=</span> <span class=n>testData</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>    <span class=n>PredProb</span> <span class=o>=</span> <span class=n>pred_prob</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>    <span class=n>DataProf</span> <span class=o>=</span> <span class=n>optimal</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>AUPRC_res</span><span class=o>$</span><span class=n>PC_pl</span>
</span></span></code></pre></div><p><figure><div class="d-flex justify-content-center"><div class=w-100><img src=https://raw.githubusercontent.com/HuaZou/Image_Host/main/img/image-20230427105628933.png alt loading=lazy data-zoomable></div></div></figure></p><h2 id=systemic-information>systemic information</h2><div class=highlight><pre tabindex=0 class=chroma><code class=language-r data-lang=r><span class=line><span class=cl><span class=n>devtools</span><span class=o>::</span><span class=nf>session_info</span><span class=p>()</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-markdown data-lang=markdown><span class=line><span class=cl>─ Session info ─────────────────────────────────────────────────────────────────────────────────────────────────────────
</span></span><span class=line><span class=cl> setting  value
</span></span><span class=line><span class=cl> version  R version 4.1.2 (2021-11-01)
</span></span><span class=line><span class=cl> os       macOS Monterey 12.2.1
</span></span><span class=line><span class=cl> system   x86_64, darwin17.0
</span></span><span class=line><span class=cl> ui       RStudio
</span></span><span class=line><span class=cl> language (EN)
</span></span><span class=line><span class=cl> collate  en_US.UTF-8
</span></span><span class=line><span class=cl> ctype    en_US.UTF-8
</span></span><span class=line><span class=cl> tz       Asia/Shanghai
</span></span><span class=line><span class=cl> date     2023-04-27
</span></span><span class=line><span class=cl> rstudio  2022.07.2+576 Spotted Wakerobin (desktop)
</span></span><span class=line><span class=cl> pandoc   2.19.2 @ /Applications/RStudio.app/Contents/MacOS/quarto/bin/tools/ (via rmarkdown)
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>─ Packages ─────────────────────────────────────────────────────────────────────────────────────────────────────────────
</span></span><span class=line><span class=cl> package      * version    date (UTC) lib source
</span></span><span class=line><span class=cl> assertthat     0.2.1      2019-03-21 [1] CRAN (R 4.1.0)
</span></span><span class=line><span class=cl> blogdown       1.13.3     2022-11-01 [1] Github (rstudio/blogdown@5dddefa)
</span></span><span class=line><span class=cl> brio           1.1.3      2021-11-30 [1] CRAN (R 4.1.0)
</span></span><span class=line><span class=cl> cachem         1.0.6      2021-08-19 [1] CRAN (R 4.1.0)
</span></span><span class=line><span class=cl> callr          3.7.0      2021-04-20 [1] CRAN (R 4.1.0)
</span></span><span class=line><span class=cl> caret        * 6.0-92     2022-04-19 [1] CRAN (R 4.1.2)
</span></span><span class=line><span class=cl> class          7.3-20     2022-01-13 [1] CRAN (R 4.1.2)
</span></span><span class=line><span class=cl> cli            3.4.1      2022-09-23 [1] CRAN (R 4.1.2)
</span></span><span class=line><span class=cl> codetools      0.2-18     2020-11-04 [1] CRAN (R 4.1.2)
</span></span><span class=line><span class=cl> colorspace     2.0-3      2022-02-21 [1] CRAN (R 4.1.2)
</span></span><span class=line><span class=cl> crayon         1.5.0      2022-02-14 [1] CRAN (R 4.1.2)
</span></span><span class=line><span class=cl> data.table   * 1.14.6     2022-11-16 [1] CRAN (R 4.1.2)
</span></span><span class=line><span class=cl> DBI            1.1.2      2021-12-20 [1] CRAN (R 4.1.0)
</span></span><span class=line><span class=cl> desc           1.4.1      2022-03-06 [1] CRAN (R 4.1.2)
</span></span><span class=line><span class=cl> devtools       2.4.3      2021-11-30 [1] CRAN (R 4.1.0)
</span></span><span class=line><span class=cl> digest         0.6.30     2022-10-18 [1] CRAN (R 4.1.2)
</span></span><span class=line><span class=cl> dplyr        * 1.0.10     2022-09-01 [1] CRAN (R 4.1.2)
</span></span><span class=line><span class=cl> e1071          1.7-9      2021-09-16 [1] CRAN (R 4.1.0)
</span></span><span class=line><span class=cl> ellipsis       0.3.2      2021-04-29 [1] CRAN (R 4.1.0)
</span></span><span class=line><span class=cl> evaluate       0.17       2022-10-07 [1] CRAN (R 4.1.2)
</span></span><span class=line><span class=cl> fansi          1.0.2      2022-01-14 [1] CRAN (R 4.1.2)
</span></span><span class=line><span class=cl> farver         2.1.0      2021-02-28 [1] CRAN (R 4.1.0)
</span></span><span class=line><span class=cl> fastmap        1.1.0      2021-01-25 [1] CRAN (R 4.1.0)
</span></span><span class=line><span class=cl> forcats        0.5.1      2021-01-27 [1] CRAN (R 4.1.0)
</span></span><span class=line><span class=cl> foreach        1.5.2      2022-02-02 [1] CRAN (R 4.1.2)
</span></span><span class=line><span class=cl> fs             1.5.2      2021-12-08 [1] CRAN (R 4.1.0)
</span></span><span class=line><span class=cl> future         1.28.0     2022-09-02 [1] CRAN (R 4.1.2)
</span></span><span class=line><span class=cl> future.apply   1.8.1      2021-08-10 [1] CRAN (R 4.1.0)
</span></span><span class=line><span class=cl> generics       0.1.2      2022-01-31 [1] CRAN (R 4.1.2)
</span></span><span class=line><span class=cl> ggplot2      * 3.4.0      2022-11-04 [1] CRAN (R 4.1.2)
</span></span><span class=line><span class=cl> globals        0.16.1     2022-08-28 [1] CRAN (R 4.1.2)
</span></span><span class=line><span class=cl> glue           1.6.2      2022-02-24 [1] CRAN (R 4.1.2)
</span></span><span class=line><span class=cl> gower          1.0.0      2022-02-03 [1] CRAN (R 4.1.2)
</span></span><span class=line><span class=cl> gtable         0.3.0      2019-03-25 [1] CRAN (R 4.1.0)
</span></span><span class=line><span class=cl> hardhat        1.2.0      2022-06-30 [1] CRAN (R 4.1.2)
</span></span><span class=line><span class=cl> htmltools      0.5.3      2022-07-18 [1] CRAN (R 4.1.2)
</span></span><span class=line><span class=cl> ipred          0.9-12     2021-09-15 [1] CRAN (R 4.1.0)
</span></span><span class=line><span class=cl> iterators      1.0.14     2022-02-05 [1] CRAN (R 4.1.2)
</span></span><span class=line><span class=cl> jsonlite       1.8.3      2022-10-21 [1] CRAN (R 4.1.2)
</span></span><span class=line><span class=cl> knitr          1.40       2022-08-24 [1] CRAN (R 4.1.2)
</span></span><span class=line><span class=cl> labeling       0.4.2      2020-10-20 [1] CRAN (R 4.1.0)
</span></span><span class=line><span class=cl> lattice      * 0.20-45    2021-09-22 [1] CRAN (R 4.1.2)
</span></span><span class=line><span class=cl> lava           1.6.10     2021-09-02 [1] CRAN (R 4.1.0)
</span></span><span class=line><span class=cl> lifecycle      1.0.3      2022-10-07 [1] CRAN (R 4.1.2)
</span></span><span class=line><span class=cl> listenv        0.8.0      2019-12-05 [1] CRAN (R 4.1.0)
</span></span><span class=line><span class=cl> lubridate      1.8.0      2021-10-07 [1] CRAN (R 4.1.0)
</span></span><span class=line><span class=cl> magrittr       2.0.3      2022-03-30 [1] CRAN (R 4.1.2)
</span></span><span class=line><span class=cl> MASS           7.3-55     2022-01-13 [1] CRAN (R 4.1.2)
</span></span><span class=line><span class=cl> Matrix         1.4-0      2021-12-08 [1] CRAN (R 4.1.0)
</span></span><span class=line><span class=cl> memoise        2.0.1      2021-11-26 [1] CRAN (R 4.1.0)
</span></span><span class=line><span class=cl> ModelMetrics   1.2.2.2    2020-03-17 [1] CRAN (R 4.1.0)
</span></span><span class=line><span class=cl> munsell        0.5.0      2018-06-12 [1] CRAN (R 4.1.0)
</span></span><span class=line><span class=cl> nlme           3.1-155    2022-01-13 [1] CRAN (R 4.1.2)
</span></span><span class=line><span class=cl> nnet           7.3-17     2022-01-13 [1] CRAN (R 4.1.2)
</span></span><span class=line><span class=cl> parallelly     1.32.1     2022-07-21 [1] CRAN (R 4.1.2)
</span></span><span class=line><span class=cl> pillar         1.7.0      2022-02-01 [1] CRAN (R 4.1.2)
</span></span><span class=line><span class=cl> pkgbuild       1.3.1      2021-12-20 [1] CRAN (R 4.1.0)
</span></span><span class=line><span class=cl> pkgconfig      2.0.3      2019-09-22 [1] CRAN (R 4.1.0)
</span></span><span class=line><span class=cl> pkgload        1.2.4      2021-11-30 [1] CRAN (R 4.1.0)
</span></span><span class=line><span class=cl> plyr           1.8.6      2020-03-03 [1] CRAN (R 4.1.0)
</span></span><span class=line><span class=cl> prettyunits    1.1.1      2020-01-24 [1] CRAN (R 4.1.0)
</span></span><span class=line><span class=cl> pROC         * 1.18.0     2021-09-03 [1] CRAN (R 4.1.0)
</span></span><span class=line><span class=cl> processx       3.5.2      2021-04-30 [1] CRAN (R 4.1.0)
</span></span><span class=line><span class=cl> prodlim        2019.11.13 2019-11-17 [1] CRAN (R 4.1.0)
</span></span><span class=line><span class=cl> proxy          0.4-26     2021-06-07 [1] CRAN (R 4.1.0)
</span></span><span class=line><span class=cl> ps             1.6.0      2021-02-28 [1] CRAN (R 4.1.0)
</span></span><span class=line><span class=cl> purrr          0.3.4      2020-04-17 [1] CRAN (R 4.1.0)
</span></span><span class=line><span class=cl> R6             2.5.1      2021-08-19 [1] CRAN (R 4.1.0)
</span></span><span class=line><span class=cl> randomForest * 4.7-1      2022-02-03 [1] CRAN (R 4.1.2)
</span></span><span class=line><span class=cl> Rcpp           1.0.10     2023-01-22 [1] CRAN (R 4.1.2)
</span></span><span class=line><span class=cl> recipes        1.0.1      2022-07-07 [1] CRAN (R 4.1.2)
</span></span><span class=line><span class=cl> remotes        2.4.2      2021-11-30 [1] CRAN (R 4.1.0)
</span></span><span class=line><span class=cl> reshape2       1.4.4      2020-04-09 [1] CRAN (R 4.1.0)
</span></span><span class=line><span class=cl> rlang          1.0.6      2022-09-24 [1] CRAN (R 4.1.2)
</span></span><span class=line><span class=cl> rmarkdown      2.17       2022-10-07 [1] CRAN (R 4.1.2)
</span></span><span class=line><span class=cl> rpart          4.1.16     2022-01-24 [1] CRAN (R 4.1.2)
</span></span><span class=line><span class=cl> rprojroot      2.0.2      2020-11-15 [1] CRAN (R 4.1.0)
</span></span><span class=line><span class=cl> rstudioapi     0.13       2020-11-12 [1] CRAN (R 4.1.0)
</span></span><span class=line><span class=cl> scales         1.2.1      2022-08-20 [1] CRAN (R 4.1.2)
</span></span><span class=line><span class=cl> sessioninfo    1.2.2      2021-12-06 [1] CRAN (R 4.1.0)
</span></span><span class=line><span class=cl> stringi        1.7.8      2022-07-11 [1] CRAN (R 4.1.2)
</span></span><span class=line><span class=cl> stringr        1.4.1      2022-08-20 [1] CRAN (R 4.1.2)
</span></span><span class=line><span class=cl> survival       3.4-0      2022-08-09 [1] CRAN (R 4.1.2)
</span></span><span class=line><span class=cl> testthat       3.1.2      2022-01-20 [1] CRAN (R 4.1.2)
</span></span><span class=line><span class=cl> tibble       * 3.1.8      2022-07-22 [1] CRAN (R 4.1.2)
</span></span><span class=line><span class=cl> tidyselect     1.1.2      2022-02-21 [1] CRAN (R 4.1.2)
</span></span><span class=line><span class=cl> timeDate       3043.102   2018-02-21 [1] CRAN (R 4.1.0)
</span></span><span class=line><span class=cl> usethis        2.1.5      2021-12-09 [1] CRAN (R 4.1.0)
</span></span><span class=line><span class=cl> utf8           1.2.2      2021-07-24 [1] CRAN (R 4.1.0)
</span></span><span class=line><span class=cl> vctrs          0.5.1      2022-11-16 [1] CRAN (R 4.1.2)
</span></span><span class=line><span class=cl> withr          2.5.0      2022-03-03 [1] CRAN (R 4.1.2)
</span></span><span class=line><span class=cl> xfun           0.34       2022-10-18 [1] CRAN (R 4.1.2)
</span></span><span class=line><span class=cl> yaml           2.3.6      2022-10-18 [1] CRAN (R 4.1.2)
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl> [1] /Library/Frameworks/R.framework/Versions/4.1/Resources/library
</span></span></code></pre></div><h2 id=summary>Summary</h2><p>Random Forest classification with optimal features using R.</p><ol><li>Data partition.</li><li>Features importance.</li><li>Cross validation for OOB errors.</li><li>The optimal features for rebuilding model.</li><li>Performance Evaluation based on optimal features.</li><li>Finalize results with AUROC and AUPRC etc.</li></ol><h2 id=reference>Reference</h2><ul><li><a href=https://github.com/Jean-njoroge/Breast-cancer-risk-prediction/ target=_blank rel=noopener>Breast-cancer-risk-prediction</a></li></ul></article><style>.btn-feedback{display:inline-block}.btn-feedback-negative{margin-left:1em}.feedback--response{display:none;margin-top:1em}.feedback--response__visible{display:block}</style><div class="d-print-none widget--feedback"><h2 class=feedback--title>Feedback</h2><p class=feedback--question>Was this page helpful?</p><p class="feedback--response feedback--response-positive">🙏</p><p class="feedback--response feedback--response-negative">🙏</p><button class="btn btn-primary mb-4 btn-feedback btn-feedback-positive">
😍 Yes</button>
<button class="btn btn-primary mb-4 btn-feedback btn-feedback-negative">
😡 No</button></div><script>const btnYes=document.querySelector(".btn-feedback-positive"),btnNo=document.querySelector(".btn-feedback-negative"),responseYes=document.querySelector(".feedback--response-positive"),responseNo=document.querySelector(".feedback--response-negative"),disableButtons=()=>{btnYes.disabled=!0,btnNo.disabled=!0},sendFeedback=e=>{if(typeof gtag!="function")return;gtag("event","click",{event_category:"page_rating",event_label:window.location.pathname,value:e,transport_type:"beacon",event_callback:function(){console.debug(`✅ Feedback sent ${e}`)}})};btnYes.addEventListener("click",()=>{console.debug("Feedback response: 😍"),responseYes.classList.add("feedback--response__visible"),disableButtons(),sendFeedback(1)}),btnNo.addEventListener("click",()=>{console.debug("Feedback response: 😡"),responseNo.classList.add("feedback--response__visible"),disableButtons(),sendFeedback(0)})</script><div class=article-tags><a class="badge badge-light" href=/tag/machine-learning/>machine learning</a>
<a class="badge badge-light" href=/tag/random-forest/>Random Forest</a></div><div class=article-widget><div class=post-nav><div class=post-nav-item><div class=meta-nav>Previous</div><a href=/post/visualization/2023-06-14-boxplotpoint/ rel=next>R visualization: boxplot with points labeled in percentage by ggplot2</a></div><div class=post-nav-item><div class=meta-nav>Next</div><a href=/post/tool/2022-11-10-metagenomics/ rel=prev>How to download taxa profile of multiple samples</a></div></div></div></div><div class=body-footer><p>Last updated on Apr 25, 2023</p></div><footer class=site-footer><p class=powered-by>© 2024 Hua Zou &#183;
Rendered by <a href=https://cran.r-project.org/ target=_blank rel=noopener><i class="fab fa-r-project"></i> </a><a href=https://github.com/rstudio/blogdown target=_blank rel=noopener>blogdown</a> ,
<a href=https://sourcethemes.com/academic/ target=_blank rel=noopener>Academic theme</a> and
<a href=https://gohugo.io target=_blank rel=noopener>Hugo</a>.
<span class=float-right aria-hidden=true><a href=# id=back_to_top><span class=button_icon><i class="fas fa-chevron-up fa-2x"></i></span></a></span></p></footer><script type=text/javascript src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script></main></div></div></div><div class=page-footer></div><script src=/js/vendor-bundle.min.d26509351aa0ff874abbee824e982e9b.js></script>
<script src=https://cdn.jsdelivr.net/gh/bryanbraun/anchorjs@4.2.2/anchor.min.js integrity="sha512-I7w3ZdSFzw5j3jU3ZkNikBNeIrl3i+hEuEdwNmqUJvwNcaBUNcijnP2gd9DtGlgVYDplfjGoD8vTNsID+lCjqg==" crossorigin=anonymous></script>
<script>anchors.add()</script><script id=page-data type=application/json>{"use_headroom":false}</script><script src=/en/js/wowchemy.min.e973d49cb2d568aa6f8eaf3638337473.js></script><div id=modal class="modal fade" role=dialog><div class=modal-dialog><div class=modal-content><div class=modal-header><h5 class=modal-title>Cite</h5><button type=button class=close data-dismiss=modal aria-label=Close>
<span aria-hidden=true>&#215;</span></button></div><div class=modal-body><pre><code></code></pre></div><div class=modal-footer><a class="btn btn-outline-primary my-1 js-copy-cite" href=# target=_blank><i class="fas fa-copy"></i> Copy</a>
<a class="btn btn-outline-primary my-1 js-download-cite" href=# target=_blank><i class="fas fa-download"></i> Download</a><div id=modal-error></div></div></div></div></div><script src=/js/wowchemy-publication.68f8d7090562ca65fc6d3cb3f8f2d2cb.js type=module></script></body></html>