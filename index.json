
    
    
    
    
    [{"authors":null,"categories":null,"content":"Hua Zou is a senior bioinformatics analyst at Xbiome Company since Mar 7 2022. My research interests include host-microbiota intersection, machine learning and multi-omics data integration. I lead the development of XMAS 2.0.\nDownload my resumé .\n","date":-62135596800,"expirydate":-62135596800,"kind":"term","lang":"en","lastmod":-62135596800,"objectID":"2525497d367e79493fd32b198b28f040","permalink":"","publishdate":"0001-01-01T00:00:00Z","relpermalink":"","section":"authors","summary":"Hua Zou is a senior bioinformatics analyst at Xbiome Company since Mar 7 2022. My research interests include host-microbiota intersection, machine learning and multi-omics data integration. I lead the development of XMAS 2.","tags":null,"title":"Hua Zou","type":"authors"},{"authors":null,"categories":["Statistics"],"content":"前言 差异分析是转录组数据分析的必需技能之一，但众多的转录组分析R包如DESeq2，limma和edgeR等让分析人员不知如何选择，还有它们之间的优劣如何？我将在本文详细探讨常用差异分析R包以及结合t-test/wilcox-rank-sum test的差异分析结果的异同点。\n大纲 本文要点由以下几点构成：\n下载以及导入测试数据（批量安装R包）；\n基因表达count矩阵的标准化方法（F(R)PKM/TPM）；\n基因整体水平分布（PCA/tSNE/UMAP；heatmap）；\nDESeq2差异分析实现以及结果解析；\nlimma差异分析实现以及结果解析；\nedgeR差异分析实现以及结果解析；\n结合t-test或wilcox-rank-sum-test方法的差异分析实现以及结果解析（是否符合正态分布选择检验方法）；\n不同方法的结果比较（volcano plot+heatmap+venn）；\n总结。\n导入R包 本次分析需要在R中批量安装包，具体安装方法可参考如何安装R包。先导入基础R包，在后面每个差异分析模块再导入所需要的差异分析R包。\nlibrary(dplyr) library(tibble) library(data.table) library(ggplot2) library(patchwork) library(cowplot) # rm(list = ls()) options(stringsAsFactors = F) options(future.globals.maxSize = 1000 * 1024^2) grp \u0026lt;- c(\u0026#34;Normal\u0026#34;, \u0026#34;Tumor\u0026#34;) grp.col \u0026lt;- c(\u0026#34;#568875\u0026#34;, \u0026#34;#73FAFC\u0026#34;) 转录组数据 本文下载的TCGA-HNSC转录组数据是通过本人先前撰写的R脚本实现的，大家可参考Downloading and preprocessing TCGA Data through R program language文章自行下载，也可以邮件询问我百度网盘密码。\n百度网盘链接：https://pan.baidu.com/s/1Daz5UsOd39T8r8K6zxPASQ\nphenotype \u0026lt;- fread(\u0026#34;TCGA-HNSC-post_mRNA_clinical.csv\u0026#34;) count \u0026lt;- fread(\u0026#34;TCGA-HNSC-post_mRNA_profile.tsv\u0026#34;) table(phenotype$Group) 标准化 标准化的目的是为了降低测序深度以及基因长度对基因表达谱下游分析的影响。测序深度越高则map到基因的reads也越多，同理基因长度越长则map到的reads也越多，最后对应的counts数目也越多。\nRPM/CPM: Reads/Counts of exon model per Million mapped reads (每百万映射读取的reads) $$RPM = \\frac{ExonMappedReads * 10^{6}}{TotalMappedReads}$$\nRPKM: Reads Per Kilobase of exon model per Million mapped reads (每千个碱基的转录每百万映射读取的reads) $$RPKM = \\frac{ExonMappedReads * 10^{9}}{TotalMappedReads * ExonLength}$$\nFPKM: Fragments Per Kilobase of exon model per Million mapped fragments(每千个碱基的转录每百万映射读取的fragments)， 适用于PE测序。 $$ FPKM = \\frac{ExonMappedFragments * 10^{9}}{TotalMappedFragments * ExonLength}$$\nTPM：Transcripts Per Kilobase of exon model per Million mapped reads (每千个碱基的转录每百万映射读取的Transcripts) $$TPM= \\frac{N_i/L_i * 10^{6}}{sum(N_1/L_1+N_2/L_2+…+N_j/L_j+…+N_n/L_n)}$$ $N_i$为比对到第i个exon的reads数； $L_i$为第i个exon的长度；sum()为所有 (n个)exon按长度进行标准化之后数值的和\n获取gene length表：对Homo_sapiens.GRCh38.101版本数据处理获取gene length数据；human_gene_all.tsv是使用biomart包获取gene symbol和ensembleID的对应关系表。 geneLength \u0026lt;- fread(\u0026#34;Homo_sapiens.GRCh38.101.genelength.tsv\u0026#34;) geneIdAll \u0026lt;- fread(\u0026#34;human_gene_all.tsv\u0026#34;) geneIdLength \u0026lt;- geneIdAll %\u0026gt;% filter(transcript_biotype == \u0026#34;protein_coding\u0026#34;) %\u0026gt;% dplyr::select(ensembl_gene_id, external_gene_name) %\u0026gt;% inner_join(geneLength, by = c(\u0026#34;ensembl_gene_id\u0026#34;=\u0026#34;V1\u0026#34;)) %\u0026gt;% dplyr::select(-ensembl_gene_id) %\u0026gt;% dplyr::distinct() %\u0026gt;% dplyr::rename(Length=V2) geneIdLengthUniq \u0026lt;- geneIdLength[pmatch(count$Feature, geneIdLength$external_gene_name), ] %\u0026gt;% filter(!is.na(Length)) %\u0026gt;% arrange(external_gene_name) count_cln \u0026lt;- count %\u0026gt;% filter(Feature%in%geneIdLengthUniq$external_gene_name) %\u0026gt;% arrange(Feature) %\u0026gt;% column_to_rownames(\u0026#34;Feature\u0026#34;) if(!any(geneIdLengthUniq$external_gene_name == rownames(count_cln))){ message(\u0026#34;Order of GeneName is wrong\u0026#34;) } gene_lengths \u0026lt;-geneIdLengthUniq$Length head(geneIdLengthUniq) RPKM/FPKM/TPM 转换 countToFpkm \u0026lt;- function(counts, lengths){ pm \u0026lt;- sum(counts) /1e6 rpm \u0026lt;- counts/pm rpm/(lengths/1000) } countToTpm \u0026lt;- function(counts, lengths) { rpk \u0026lt;- counts/(lengths/1000) coef \u0026lt;- sum(rpk) / 1e6 rpk/coef } # FPKM count_FPKM \u0026lt;- apply(count_cln, 2, function(x){countToFpkm(x, gene_lengths)}) %\u0026gt;% data.frame() # TPM count_TPM \u0026lt;- apply(count_cln, 2, function(x){countToTpm(x, gene_lengths)}) %\u0026gt;% data.frame() head(count_cln) head(count_FPKM) head(count_TPM) 整体水平比较 在做差异分析前，一般可以对数据做一个降维处理，然后看不同分组是否能在二维展开平面区分开。\nExpressionSet 先将数据存成ExpressionSet格式，可参考RNA-seq数据的批次校正方法文章。ExpressionSet对象数据包含表达谱和metadata等数据，这方便后期分析。\ngetExprSet \u0026lt;- function(metadata=phenotype, profile=count_cln, occurrence=0.2){ # metadata=phenotype # profile=count_cln # occurrence=0.2 sid \u0026lt;- intersect(metadata$SampleID, colnames(profile)) # phenotype phe \u0026lt;- metadata %\u0026gt;% filter(SampleID%in%sid) %\u0026gt;% column_to_rownames(\u0026#34;SampleID\u0026#34;) # profile by occurrence prf \u0026lt;- profile %\u0026gt;% rownames_to_column(\u0026#34;tmp\u0026#34;) %\u0026gt;% filter(apply(dplyr::select(., -one_of(\u0026#34;tmp\u0026#34;)), 1, function(x) { sum(x != 0)/length(x)}) \u0026gt; occurrence) %\u0026gt;% dplyr::select(c(tmp, rownames(phe))) %\u0026gt;% column_to_rownames(\u0026#34;tmp\u0026#34;) # determine the right order between profile and phenotype for(i in 1:ncol(prf)){ if (!(colnames(prf)[i] == rownames(phe)[i])) { stop(paste0(i, \u0026#34; Wrong\u0026#34;)) } } require(convert) exprs \u0026lt;- as.matrix(prf) adf \u0026lt;- new(\u0026#34;AnnotatedDataFrame\u0026#34;, data=phe) experimentData \u0026lt;- new(\u0026#34;MIAME\u0026#34;, name=\u0026#34;Hua Zou\u0026#34;, lab=\u0026#34;UCAS\u0026#34;, contact=\u0026#34;zouhua@outlook.com\u0026#34;, title=\u0026#34;TCGA-HNSC\u0026#34;, abstract=\u0026#34;The gene ExpressionSet\u0026#34;, url=\u0026#34;www.zouhua.top\u0026#34;, other=list(notes=\u0026#34;Created from text files\u0026#34;)) expressionSet \u0026lt;- new(\u0026#34;ExpressionSet\u0026#34;, exprs=exprs, phenoData=adf, experimentData=experimentData) return(expressionSet) } ExprSet_count \u0026lt;- getExprSet(profile=count_cln) ExprSet_FPKM \u0026lt;- getExprSet(profile=count_FPKM) ExprSet_TPM \u0026lt;- getExprSet(profile=count_TPM) ExprSet_count ExprSet_FPKM ExprSet_TPM 降维分析 高纬度数据降维方法很多，我们这里选择了PCA+tSNE+UMAP分别展示降维后的结果，可参考文章高纬度数据降维方法的R实现。另外合并多个图的方法，请参考文章patchwork:合并多个R图的包。\nPCA PCAFun \u0026lt;- function(dataset = ExprSet_count){ # dataset = ExprSet_count require(convert) metadata \u0026lt;- pData(dataset) profile \u0026lt;- …","date":1666919594,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1666919594,"objectID":"502dca6c954348598c688fab47f1c873","permalink":"https://zouhua.top/post/math_statistics/2022-10-27-da-methods-comparsion/","publishdate":"2022-10-27T20:13:14-05:00","relpermalink":"/post/math_statistics/2022-10-27-da-methods-comparsion/","section":"post","summary":"差异分析是转录组数据分析的必备技能之一，但众多的转录组分析R包*DESeq2*，*limma*和*edgeR*让分析人员有选择问题，那么它们之间的优劣到底是如何的呢?","tags":["RNA-seq","DifferentialAnalysis"],"title":"转录组差异分析（DESeq2+limma+edgeR+t-test/wilcox-test）总结","type":"post"},{"authors":null,"categories":["Tool"],"content":"Introduction Have you ever thought about making your own website using R and Rstudio? This tutorial would teach you how to create your personal blog via blogdown and github. What’s more, automatically eploying your website is also necessary by using github actions.\nPrerequisites Before running the tutorial, you need have this software in your PC\nR\nRstudio\nRegistering github account Please go to github to obtain your own account. Then create a new repository named [your_github_names].github.io which is applied to render your github pages.\nCreating repository for blog Creating another private repository (named MyBlog) to save your files which are used to setup blog. Here, suggesting users create two repositories to deploy personal website according to the protection of personal privacy.\n[your_github_names].github.io for saving blog html files MyBlog for saving blog source files Install Blogdown and Hugo Blogdown which Creating Blogs and Websites with R Markdown is necessary for building website\n# Install blogdown #install.packages(\u0026#34;blogdown\u0026#34;) remotes::install_github(\u0026#39;rstudio/blogdown\u0026#39;) # Install Hugo blogdown::install_hugo() Creating blogdown project Firstly, open Rstudio to create New Project -\u0026gt; New Directory -\u0026gt; Website using blogdown and then give MyOwnWebsite to Directory name, and then setting Hugo theme by gcushen/hugo-academic. Finally, Kick Create Project to generate website.\nThen, opening Rstudio to create blogdown project (File -\u0026gt; New Project -\u0026gt; Website using blogdown -\u0026gt; New Prject Wizard -\u0026gt; Create Project). YOu could see the following files and directories.\nthe final website folder like this\nBuilding website To build the website by using hugo_build from blogdown R package.\nblogdown::hugo_build(local=TRUE) All the actual files of the website are stored in public/ folder.\nTo preview the website using\nblogdown::serve_site() config.yaml: Hugo and theme configuration file. .Rprofile: File to set up your blogdown options. netlify.toml: File to set up your Netlify options. content/: Website source files to edit and add, such as blog posts. themes/: Hugo theme. Basic Customization The basic files that you want to modify to customize your website are the following:\nconfig/_default/config.yaml: general website information config/_default/params.yaml: website customization config/_default/menus.yaml: top bar / menu customization content/authors/admin/_index.md: personal information Uploading blogdown project to MyBlog Repository Moving the files of blogdown into MyOwnWebsite directory and then using git to push all the files to the remote repository.\nCreating Github Actions Opening MyBlog Repository (Actions -\u0026gt; New workflow) to create deploy.yml.\nname: deploy_blog on: push: branches: [main, master] pull_request: branches: [main, master] release: types: [published] workflow_dispatch: jobs: build: runs-on: ubuntu-latest steps: - name: checkout uses: actions/checkout@v3 with: submodules: true - name: Setup Hugo uses: peaceiris/actions-hugo@v2.5.0 with: hugo-version: \u0026#39;0.105.0\u0026#39; extended: true - name: Build run: hugo --minify - name: Deploy uses: peaceiris/actions-gh-pages@v3.8.0 with: deploy_key: ${{ secrets.ACTIONS_DEPLOY_KEY }} external_repository: HuaZou/HuaZou.github.io publish_branch: master publish_dir: ./public allow_empty_commit: true Deployment We need to connect the Github Pages repository ([your_github_names].github.io) and blog repository (MyBlog) through ssh key. Go to ~/.ssh/.\nssh-keygen -t rsa -C \u0026#34;zouhua1@outlook.com\u0026#34; private key is for MyOwnWebsite (settings -\u0026gt; Secrets)\npublic key is for [your_github_names].github.io (Deploy keys)\nWhen you upload your files to MyOwnWebsite and github will automatically compile the files and then deploy html files to [your_github_names].github.io to render your website.\nReference How To Make A Personal Website with Hugo ","date":1661217194,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1661217194,"objectID":"4b8eda7a56d5803a903c60e6acb57df4","permalink":"https://zouhua.top/post/tool/2022-08-22-blogdown-hugo/","publishdate":"2022-08-22T20:13:14-05:00","relpermalink":"/post/tool/2022-08-22-blogdown-hugo/","section":"post","summary":"Introduction Have you ever thought about making your own website using R and Rstudio? This tutorial would teach you how to create your personal blog via blogdown and github. What’s more, automatically eploying your website is also necessary by using github actions.","tags":["blogdown","github","hugo"],"title":"How to setup personal blog by blogdown and githup pages","type":"post"},{"authors":["Hua Zou"],"categories":null,"content":"","date":1660867200,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1660867200,"objectID":"87c79596733bec228d6c7e28407533a7","permalink":"https://zouhua.top/bookdown/2022-xmas2/","publishdate":"2022-08-19T00:00:00Z","relpermalink":"/bookdown/2022-xmas2/","section":"bookdown","summary":"In this tutorial, we focus on differential analysis with the step-by-step procedures by using the R programming language. We also briefly introduce the concepts and principals of the statistical methods before the applications and give conclusions on the results.","tags":null,"title":"Statistical toolkits on microbiota data","type":"bookdown"},{"authors":["Hua Zou","Dan Wang","Huahui Ren"],"categories":null,"content":"","date":1582502400,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1582502400,"objectID":"20d79b52d65fe064fabe61be5389ae1c","permalink":"https://zouhua.top/publication/2020-nutrients/","publishdate":"2020-02-24T00:00:00Z","relpermalink":"/publication/2020-nutrients/","section":"publication","summary":"This non-controlled intervention study revealed associations between baseline gut microbiota and CR-induced BMI loss and provided evidence to accelerate the application of microbiome stratification in future personalized nutrition intervention.","tags":null,"title":"Effect of Caloric Restriction on BMI, Gut Microbiota, and Blood Amino Acid Levels in Non-Obese Adults","type":"publication"}]